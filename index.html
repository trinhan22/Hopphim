<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WibuPhim - Phim Hay Trong T·∫ßm Tay</title>
    
    <meta property="og:title" content="WibuPhim - Phim Hay Trong T·∫ßm Tay" />
    <meta property="og:description" content="Trang xem phim tr·ª±c tuy·∫øn mi·ªÖn ph√≠ ch·∫•t l∆∞·ª£ng cao." />
    <meta property="og:image" content="https://wibuphim.netlify.app/panel.webp" />
    <meta property="og:url" content="https://wibuphim.netlify.app" />
    <meta property="og:type" content="article" />

    <link rel="icon" type="image/webp" href="/LOGO.WEBP" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ==========================================================================
           1. CSS CORE & VARIABLES (DESIGN SYSTEM)
           ========================================================================== 
        */
        :root {
            --bg-body: #191b24; 
            --bg-dark: #0f111a; 
            --bg-panel: #23252f; 
            --text-main: #ffffff; 
            --text-sub: #a0a0a0;
            --gradient-main: linear-gradient(135deg, #FF8F50 0%, #FF5E62 100%); 
            --primary-color: #FF5E62;
            --gold-color: linear-gradient(90deg, #FF8F50, #FF5E62);
            --font-main: 'Inter', sans-serif; 
            --card-radius: 12px;
            --mobile-menu-bg: #15171e;
            --mobile-border: rgba(255,255,255,0.05);
            --transition-smooth: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            --z-header: 5000;
            --z-modal: 10000;
            --z-hover-detail: 99999;
        }

        /* Basic Resets */
        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
            outline: none; 
            -webkit-tap-highlight-color: transparent; 
        }

        body { 
            font-family: var(--font-main); 
            background-color: var(--bg-body); 
            color: var(--text-main); 
            overflow-x: hidden; 
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        a { text-decoration: none; color: inherit; transition: var(--transition-smooth); }
        ul { list-style: none; }
        button { border: none; cursor: pointer; font-family: var(--font-main); }

        /* Custom Scroller */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary-color); }

        /* ==========================================================================
           2. UTILITY CLASSES & KEYFRAMES
           ========================================================================== 
        */
        .text-gradient { 
            background: var(--gradient-main); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            display: inline-block; 
            font-weight: 800;
        }

        @keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes zoomIn { from { transform: scale(1.1); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes floatIdle { 0% { transform: scale(1); } 50% { transform: scale(0.9); } 100% { transform: scale(1); } }
        @keyframes rotateBlur { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* ==========================================================================
           3. TOAST & CONFIRM COMPONENTS
           ========================================================================== 
        */
        #toast-container { position: fixed; top: 20px; right: 20px; z-index: 20000; display: flex; flex-direction: column; gap: 10px; pointer-events: none; }
        .toast { 
            background: #23252f; color: #fff; padding: 12px 22px; border-radius: 12px; 
            display: flex; align-items: center; gap: 12px; min-width: 280px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); border-left: 4px solid var(--primary-color); 
            animation: slideInRight 0.3s cubic-bezier(0.16, 1, 0.3, 1); pointer-events: auto; 
        }
        .toast.success { border-left-color: #2ecc71; }
        .toast.error { border-left-color: #ff4757; }
        .toast i { font-size: 1.2rem; }

        .custom-confirm-overlay { 
            position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 20001; 
            display: none; justify-content: center; align-items: center; 
            opacity: 0; transition: 0.3s; backdrop-filter: blur(8px); 
        }
        .custom-confirm-overlay.active { display: flex; opacity: 1; }
        
        .confirm-box { 
            background: #1f222e; width: 90%; max-width: 400px; padding: 35px; 
            border-radius: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.1); 
            transform: scale(0.9); transition: 0.3s cubic-bezier(0.16, 1, 0.3, 1); 
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); 
        }
        .confirm-icon { font-size: 3rem; margin-bottom: 15px; background: var(--gradient-main); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .confirm-actions { display: flex; justify-content: center; gap: 15px; margin-top: 25px; }
        
        .btn-confirm { padding: 10px 25px; border-radius: 8px; font-weight: 700; transition: 0.3s; }
        .btn-cancel { background: rgba(255,255,255,0.1); color: #ccc; }
        .btn-cancel:hover { background: rgba(255,255,255,0.2); color: #fff; }
        .btn-ok { background: var(--gradient-main); color: #fff; box-shadow: 0 5px 15px rgba(255, 94, 98, 0.3); }
        .btn-ok:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(255, 94, 98, 0.5); }

        /* ==========================================================================
           4. LOADING SCREEN
           ========================================================================== 
        */
        #loadingScreen { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh; 
            background: var(--bg-body); z-index: 9999; display: flex; 
            justify-content: center; align-items: center; 
        }
        
        .loading-img { 
            width: 800px; /* Ch·ªânh l·∫°i k√≠ch th∆∞·ªõc cho v·ª´a v·∫∑n */
            max-width: 90vw; height: auto; object-fit: contain; 
            /* Animation m·∫∑c ƒë·ªãnh: Hi·ªán ra -> Bay l∆° l·ª≠ng */
            animation: zoomIn 0.8s ease-out forwards, floatIdle 3s ease-in-out infinite 0.8s; 
        }
        
        /* Class n√†y s·∫Ω ƒë∆∞·ª£c JS th√™m v√†o khi t·∫£i xong */
        .loading-img.zoom-out { 
            /* D√πng ease-in ƒë·ªÉ t·∫°o c·∫£m gi√°c h√∫t nhanh v√†o trong */
            animation: zoomOut 0.5s ease-in forwards !important; 
        }

        /* Hi·ªáu ·ª©ng l√∫c m·ªõi v√†o trang */
        @keyframes zoomIn { 0% { transform: scale(1.36); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes floatIdle { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        
        /* --- üî• S·ª¨A ƒêO·∫†N N√ÄY: H√öT V√ÄO TRONG --- */
        @keyframes zoomOut { 
            36% { transform: scale(1); opacity: 1; } 
            100% { transform: scale(0.36); opacity: 0; } /* scale(0) l√† thu nh·ªè bi·∫øn m·∫•t */
        }

        /* ==========================================================================
           5. HEADER (MOBILE REMASTERED)
           ========================================================================== 
        */
        header { 
            position: fixed; top: 0; width: 100%; height: 70px; padding: 0 4%; 
            display: flex; justify-content: space-between; align-items: center; 
            z-index: 1000; background: transparent; transition: all 0.3s ease-in-out; 
        }
        header.scrolled { background: var(--bg-dark); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4); }
        
        /* Desktop Components */
        .header-left-group { display: flex; align-items: center; gap: 30px; height: 100%; }
        .logo { display: flex; align-items: center; gap: 10px; cursor: pointer; z-index: 1002; }
        .logo img { height: 40px; object-fit: contain; }
        .logo-text { font-size: 1.5rem; font-weight: 900; letter-spacing: 1px; text-transform: uppercase; background: var(--gradient-main); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        
        .nav-links { display: flex; gap: 15px; list-style: none; height: 100%; align-items: center; }
        .nav-item { position: relative; height: 100%; display: flex; align-items: center; padding: 0 10px; cursor: pointer; }
        .nav-link { color: #ccc; text-decoration: none; font-size: 14px; font-weight: 600; text-transform: uppercase; transition: 0.3s; white-space: nowrap; display: flex; align-items: center; gap: 5px; }
        .nav-item:hover .nav-link { color: #fff; }
        .nav-link i { font-size: 0.8rem; margin-top: -2px; }

        /* Dropdown */
        .dropdown-menu { display: none; position: absolute; top: 70px; left: 0; background: rgba(15, 17, 26, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-top: 2px solid var(--primary-color); padding: 20px; border-radius: 0 0 12px 12px; width: 500px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); transform-origin: top left; animation: fadeIn 0.2s ease-out; }
        .dropdown-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .dropdown-item-link { color: #a0a0a0; text-decoration: none; font-size: 0.9rem; transition: 0.2s; padding: 5px 8px; border-radius: 6px; }
        .dropdown-item-link:hover { color: #fff; background: rgba(255,255,255,0.1); }
        .nav-item:hover .dropdown-menu { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .right-elements { display: flex; align-items: center; gap: 15px; }
        .search-box { display: flex; align-items: center; background: rgba(255,255,255,0.08); padding: 8px 18px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.05); }
        .search-box input { background: transparent; border: none; color: #fff; margin-left: 10px; font-family: var(--font-main); font-size: 14px; width: 150px; }
        
        .btn-login { background: var(--gradient-main); color: #fff; border: none; padding: 8px 20px; border-radius: 50px; font-weight: 700; font-size: 0.9rem; cursor: pointer; transition: 0.3s; }
        .user-avatar { width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--primary-color); cursor: pointer; display: none; object-fit: cover; }
        .user-dropdown { position: absolute; top: 100%; right: 0; width: 220px; margin-top: 15px; background: #23252f; border-radius: 8px; padding: 5px; box-shadow: 0 15px 40px rgba(0,0,0,0.6); display: none; flex-direction: column; border: 1px solid rgba(255,255,255,0.1); }
        .user-dropdown.active { display: flex; }
        .user-info-item { padding: 12px; color: #fff; font-weight: bold; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .dropdown-item { background: transparent; border: none; color: #ccc; text-align: left; padding: 10px; cursor: pointer; display: flex; align-items: center; gap: 10px; }
        .dropdown-item:hover { background: rgba(255,255,255,0.1); color: #fff; }
        
        /* --- NEW MOBILE HEADER ELEMENTS --- */
        .mobile-left-container { display: none; align-items: center; gap: 12px; }
        .mobile-menu-toggle { font-size: 1.6rem; color: #fff; cursor: pointer; }
        .mobile-search-trigger { display: none; font-size: 1.5rem; color: #fff; cursor: pointer; }

        @media (max-width: 900px) {
            header { height: 65px; padding: 0 15px; justify-content: space-between; background: var(--bg-dark); }
            /* ·∫®n Desktop Elements */
            .header-left-group, .nav-links, .search-box, .desktop-auth { display: none !important; }
            
            /* Hi·ªán Mobile Left (Menu + Logo) */
            .mobile-left-container { display: flex !important; }
            .mobile-left-container .logo { position: static; transform: none; margin: 0; }
            .mobile-left-container .logo img { height: 32px; }
            .mobile-left-container .logo-text { font-size: 1.2rem; }

            /* Hi·ªán Mobile Right (Search) */
            .mobile-search-trigger { display: block !important; }
        }

        /* --- MOBILE MENU DRAWER (NEW STYLE) --- */
        .mobile-overlay { position: fixed; inset: 0; z-index: 10000; transition: 0.4s cubic-bezier(0.77, 0, 0.175, 1); visibility: hidden; }
        .mobile-overlay.active { visibility: visible; }
        
            #mobileMenuOverlay { 
                display: flex; 
                flex-direction: column;
                position: fixed; /* QUAN TR·ªåNG: Ghim menu v√†o m√†n h√¨nh */
                top: 0; 
                left: 0; 
                width: 300px; 
                height: 100vh; /* QUAN TR·ªåNG: Chi·ªÅu cao b·∫±ng ƒë√∫ng m√†n h√¨nh thi·∫øt b·ªã */
                background: var(--mobile-menu-bg); 
                box-shadow: 20px 0 60px rgba(0,0,0,0.8); 
                transform: translateX(-100%); 
                transition: 0.4s cubic-bezier(0.77, 0, 0.175, 1); 
                z-index: 10001; /* ƒê·∫£m b·∫£o n·∫±m tr√™n c√πng */
            }
            #mobileMenuOverlay.active { transform: translateX(0); }

        .drawer-header { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .drawer-content { flex: 1; overflow-y: auto; padding: 10px 0; }
        
        /* User Profile Button in Drawer */
        .drawer-user-card { padding: 20px; }
        .drawer-user-btn {
            width: 100%; background: var(--gradient-main); border-radius: 8px;
            padding: 12px; display: flex; align-items: center; justify-content: center; gap: 10px;
            color: #fff; font-weight: 700; box-shadow: 0 5px 15px rgba(255, 94, 98, 0.4); cursor: pointer;
        }
        .drawer-user-btn img { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #fff; object-fit: cover; }

        .drawer-item { display: flex; align-items: center; gap: 15px; padding: 12px 25px; color: #ccc; text-decoration: none; font-weight: 600; font-size: 0.95rem; transition: 0.2s; }
        .drawer-item:hover { background: rgba(255,255,255,0.05); color: #fff; }
        .drawer-item i { width: 20px; text-align: center; color: var(--primary-color); }
        .drawer-label { color: #666; font-size: 0.75rem; font-weight: 800; padding: 15px 25px 5px; text-transform: uppercase; margin-top: 10px; }
        
        .backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.7); opacity: 0; transition: 0.4s; z-index: -1; }
        .mobile-overlay.active .backdrop { opacity: 1; }

        /* --- MOBILE SEARCH OVERLAY (SLIDE DOWN) --- */
        #mobileSearchOverlay { display: block; background: #1f212d; transform: translateY(-100%); opacity: 0; }
        #mobileSearchOverlay.active { transform: translateY(0) !important; opacity: 1 !important; }

        #mobileSearchOverlay .close-btn-overlay { position: static; color: #fff; }

        .ms-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
        .ms-input-group { display: flex; align-items: center; gap: 10px; flex: 1; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 10px; }
        .ms-input-group input { background: transparent; border: none; color: #fff; font-size: 1.2rem; width: 100%; outline: none; }

        /* =========================================
           HERO SLIDER - PHONG C√ÅCH NETFLIX (FIXED)
           ========================================= */
        .hero-wrapper {
            position: relative;
            width: 100%;
            height: 85vh;
            overflow: hidden;
            margin-bottom: 0;
            background: #000;
        }

        /* --- HI·ªÜU ·ª®NG KH√ìI/S∆Ø∆†NG M√ô (NEW) --- */
        .hero-fog {
            position: absolute;
            inset: 0;
            z-index: 2; /* N·∫±m tr√™n overlay n·ªÅn nh∆∞ng d∆∞·ªõi ch·ªØ */
            pointer-events: none;
            
            /* T·∫°o kh√≥i 2 b√™n v√† ·ªü tr√™n b·∫±ng shadow c·ª±c l·ªõn */
            box-shadow: inset 0 0 150px 100px (var(--bg-body));
            
            /* Ho·∫∑c d√πng Gradient ph·ª©c t·∫°p h∆°n ƒë·ªÉ t·∫°o ƒë·ªô loang l·ªï t·ª± nhi√™n */
            background: 
                /* Kh√≥i b√™n tr√™n */
                linear-gradient(to bottom, var(--bg-body) 0%, transparent 20%);
        }

        .hero-wrapper::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 300px; /* TƒÉng ƒë·ªô cao l√™n ch√∫t cho m∆∞·ª£t */
            background: linear-gradient(to bottom, transparent 0%, var(--bg-body) 85%);
            z-index: 5;
            pointer-events: none;
        }

        .hero-slide {
            position: absolute;
            inset: 0;
            background-size: cover;
            background-position: center center;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            display: flex;
            align-items: center; /* CƒÉn gi·ªØa d·ªçc */
        }

        .hero-slide.active { opacity: 1; z-index: 1; }

        /* L·ªõp ph·ªß Gradient: ƒêen ·ªü d∆∞·ªõi v√† tr√°i, trong su·ªët ·ªü tr√™n ph·∫£i */
        .hero-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.6) 40%, transparent 100%),
                        linear-gradient(to top, #191b24 5%, transparent 40%);
            z-index: 1;
            pointer-events: none;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            width: 50%;
            padding-left: 5%;
            display: flex;
            flex-direction: column;
            gap: 15px;
            animation: fadeUp 0.8s ease-out 0.3s forwards;
            opacity: 0; transform: translateY(30px);
        }

        /* T√™n g·ªëc (Ti·∫øng Anh) - Style M·ªõi: M·ªèng & N·∫±m d∆∞·ªõi */
        .hero-origin-name {
            color: #f1c40f; /* M√†u v√†ng ngh·ªá gi·ªëng ·∫£nh m·∫´u */
            font-size: 1.1rem;
            font-weight: 300; /* Thin (M·ªèng) */
            font-family: 'Inter', sans-serif;
            
            /* B·ªè vi·∫øt hoa to√†n b·ªô ƒë·ªÉ gi·ªëng ·∫£nh m·∫´u (Title Case) */
            text-transform: none; 
            letter-spacing: 0.5px;
            
            margin-top: -10px; /* K√©o l√™n g·∫ßn Logo h∆°n */
            margin-bottom: 0px;
            
            text-shadow: 1px 1px 2px rgba(0,0,0,1);
        }

        /* T√™n ch√≠nh - M√†u TR·∫ÆNG + B√≥ng ƒë·ªï ƒë·∫≠m */
        .hero-title-main {
            font-size: 3.8rem;
            font-weight: 900;
            line-height: 1.1;
            color: #ffffff; /* Tr·∫Øng tinh */
            text-shadow: 0 0 10px rgba(0,0,0,0.5), 2px 2px 4px rgba(0,0,0,0.8); /* Vi·ªÅn b√≥ng gi√∫p t√°ch n·ªÅn */
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        /* Tinh ch·ªânh l·∫°i Logo */
        .hero-title-image {
            max-width: 300px;
            height: auto;
            max-height: 150px;
            object-fit: contain;
            
            margin-bottom: -10px; 
            
            /* üëá TH√äM D√íNG N√ÄY: K√©o l√πi v·ªÅ b√™n tr√°i 10px */
            margin-left: -10px; 
            
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.6));
            display: block;
            animation: fadeUp 0.8s ease-out 0.4s forwards;
            opacity: 0; transform: translateY(20px);
        }

        /* Mobile: Thu nh·ªè logo l·∫°i */
        @media (max-width: 900px) {
            .hero-title-image {
                max-width: 280px;
                max-height: 120px;
                margin: 0 auto 15px; /* CƒÉn gi·ªØa tr√™n mobile */
            }
        }

        .hero-meta {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.9rem;
            color: #fff;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,1);
        }

        .imdb-badge {
            background: #F5C518;
            color: #000;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 900;
        }

        .quality-badge {
            border: 1px solid #fff;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8rem;
            background: rgba(0,0,0,0.3);
        }

        .hero-desc {
            color: #ddd; /* M√†u x√°m s√°ng */
            font-size: 1rem;
            line-height: 1.6;
            max-width: 90%;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            font-weight: 500;
        }

        /* N√∫t Play Tr√≤n */
        .hero-actions { display: flex; align-items: center; gap: 20px; }
        
        .btn-play-circle {
            width: 70px; height: 70px;
            background: var(--gradient-main); /* D√πng m√†u cam ch·ªß ƒë·∫°o */
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 0 30px rgba(255, 94, 98, 0.4);
            border: 2px solid rgba(255,255,255,0.2);
        }
        .btn-play-circle i { font-size: 2rem; color: #fff; margin-left: 5px; }
        .btn-play-circle:hover { transform: scale(1.1); box-shadow: 0 0 50px rgba(255, 94, 98, 0.6); }

        .btn-action-icon {
            width: 50px; height: 50px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.3);
            display: flex; align-items: center; justify-content: center;
            color: #fff; cursor: pointer; transition: 0.3s;
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(5px);
        }
        .btn-action-icon:hover { background: #fff; color: #000; border-color: #fff; }

        /* Thumbnails List */
        .hero-thumbnails {
            position: absolute;
            bottom: 130px; /* TƒÉng l√™n t·ª´ 40px -> 130px */
            right: 4%;
            z-index: 10;
            display: flex;
            gap: 15px;
        }
        
        .thumb-item {
            width: 140px; height: 80px;
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid rgba(255,255,255,0.3);
            transition: 0.3s;
            position: relative;
        }
        .thumb-item img { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.5); transition: 0.3s; }
        
        .thumb-item.active { border-color: var(--primary-color); transform: scale(1.1); box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .thumb-item.active img { filter: brightness(1); }
        .thumb-item:hover img { filter: brightness(1); }

        /* Responsive */
        @media (max-width: 900px) {
            .hero-wrapper { height: 75vh; }
            .hero-thumbnails { display: none; }
            .hero-content { width: 100%; padding: 0 20px; align-items: center; text-align: center; bottom: 0; justify-content: center; height: 100%; }
            .hero-overlay { background: linear-gradient(to top, #191b24 10%, rgba(0,0,0,0.6) 60%, rgba(0,0,0,0.4) 100%); }
            .hero-title-main { font-size: 2.2rem; }
            .hero-actions { justify-content: center; }
        }
        /* ==========================================================================
           TOPICS SECTION
           ========================================================================== */
        .topics-section {
            position: relative;
            padding: 0 4%;
            /* K√©o l√™n 100px ƒë·ªÉ ƒë√® l√™n Hero */
            margin-top: -100px; 
            z-index: 20; /* Quan tr·ªçng: Ph·∫£i cao h∆°n Hero ƒë·ªÉ n·ªïi l√™n tr√™n */
            margin-bottom: 60px;
        }
        .section-label { font-size: 1.4rem; font-weight: 800; margin-bottom: 25px; color: #fff; letter-spacing: -0.5px; }
        .topic-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 20px; }
        
        .topic-card {
            /* Th√™m backdrop-filter m·∫°nh h∆°n ƒë·ªÉ t√°ch bi·ªát kh·ªèi n·ªÅn hero */
            backdrop-filter: blur(20px) saturate(180%);
            background: rgba(30, 32, 40, 0.6); /* N·ªÅn t·ªëi b√°n trong su·ªët */
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            /* ... gi·ªØ nguy√™n c√°c thu·ªôc t√≠nh kh√°c ... */
            height: 115px; border-radius: 20px; padding: 22px; 
            display: flex; flex-direction: column; justify-content: space-between; 
            cursor: pointer; position: relative; overflow: hidden; 
            transition: all 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
            isolation: isolate;
        }
        .topic-card:hover { transform: translateY(-8px); border-color: rgba(255, 255, 255, 0.2); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4); }
        .topic-card::before { content: ''; position: absolute; top: 50%; left: 50%; width: 120px; height: 120px; border-radius: 50%; transform: translate(-50%, -50%); filter: blur(40px); opacity: 0.3; z-index: -2; transition: all 0.6s ease; }
        .topic-card:hover::before { width: 160px; height: 160px; opacity: 0.6; }
        .topic-card::after { content: ''; position: absolute; bottom: -20%; right: -10%; width: 80px; height: 80px; border-radius: 50%; filter: blur(30px); opacity: 0; z-index: -1; transition: all 0.6s ease; }
        .topic-card:hover::after { opacity: 0.4; transform: translate(-10px, -10px); }
        .topic-card i.floating-icon { position: absolute; bottom: -8px; right: -5px; font-size: 3.8rem; color: rgba(255, 255, 255, 0.05); transform: rotate(-15deg); transition: 0.5s; z-index: -1; }
        .topic-card:hover i.floating-icon { color: rgba(255, 255, 255, 0.12); transform: rotate(0deg) scale(1.1); }
        .topic-name { font-size: 1.3rem; font-weight: 900; z-index: 2; position: relative; text-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .topic-link { font-size: 0.8rem; font-weight: 800; display: flex; align-items: center; gap: 6px; z-index: 2; position: relative; color: rgba(255,255,255,0.6); transition: 0.3s; }
        .topic-card:hover .topic-link { color: #fff; gap: 10px; }

        /* Color Mixins */
        .bg-marvel::before { background: #ed1d24; } .bg-marvel::after { background: #ff8e0d; }
        .bg-sitcom::before { background: #00d2ff; } .bg-sitcom::after { background: #3a7bd5; }
        .bg-voice::before { background: #ff75c3; } .bg-voice::after { background: #56CCF2; }
        .bg-trans::before { background: #8e44ad; } .bg-trans::after { background: #ff00cc; }
        .bg-ancient::before { background: #f1c40f; } .bg-ancient::after { background: #e67e22; }
        .bg-4k::before { background: #ffffff; } .bg-4k::after { background: #2c3e50; }

        /* ==========================================================================
           7. MERGED COUNTRY BLOCK & GRID FIX
           ========================================================================== 
        */
        .merged-block { 
            background: var(--bg-panel); border-radius: 24px; margin: 0 4% 60px; 
            padding: 30px 45px; border: 1px solid rgba(255,255,255,0.05); 
            box-shadow: 0 25px 70px rgba(0,0,0,0.3); overflow: visible !important; isolation: isolate;
        }
        .country-section { margin-bottom: 40px; position: relative; overflow: visible !important; }
        .country-section:last-child { margin-bottom: 0; }
        .country-section:not(:last-child) { border-bottom: 1px solid rgba(255,255,255,0.04); padding-bottom: 20px; }
        .country-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 30px; }
        .ch-title { font-size: 2.2rem; font-weight: 900; letter-spacing: -0.5px; }
        .ch-link { font-size: 1rem; color: var(--text-sub); display: flex; align-items: center; gap: 10px; cursor: pointer; font-weight: 700; }
        .grid-wrapper { position: relative; width: 100%; overflow: visible !important; }
        
        .nav-arrow {
            position: absolute; top: 50%; transform: translateY(-50%); width: 50px; height: 50px; 
            background: rgba(0,0,0,0.85); border: 1px solid rgba(255,255,255,0.15); color: #fff;
            border-radius: 50%; cursor: pointer; z-index: 1002; display: flex; align-items: center; justify-content: center;
            opacity: 0; transition: var(--transition-smooth); backdrop-filter: blur(5px);
        }
        .grid-wrapper:hover .nav-arrow { opacity: 1; }
        .arrow-prev { left: -25px; } .arrow-next { right: -25px; }
        .nav-arrow:hover { background: var(--primary-color); border-color: transparent; transform: translateY(-50%) scale(1.1); }

        /* üî•üî•üî• THE ULTIMATE FIX FOR CLIPPING (PH·∫†M VI HOVER) üî•üî•üî•
           K·ªπ thu·∫≠t: Deep Padding Buffer + Negative Margin
           - TƒÉng padding-top l√™n 100px ƒë·ªÉ ch·ª©a card hover bay l√™n.
           - TƒÉng padding ngang 40px ƒë·ªÉ ch·ª©a scale.
           - D√πng margin √¢m ƒë·ªÉ k√©o layout v·ªÅ v·ªã tr√≠ c≈©.
        */
        .country-grid { 
            display: flex; flex-wrap: nowrap; gap: 20px; 
            overflow-x: auto !important; scroll-behavior: smooth; scrollbar-width: none;
            /* DEEP PADDING FIX */
            padding-top: 100px !important; 
            padding-bottom: 40px !important; 
            padding-left: 40px !important; 
            padding-right: 40px !important;
            /* NEGATIVE MARGIN FIX */
            margin-top: -100px !important; 
            margin-bottom: -40px !important;
            margin-left: -40px !important; 
            margin-right: -40px !important;
        }
        .country-grid::-webkit-scrollbar { display: none; }

        /* ==========================================================================
           NEW CARD SYSTEM (INLINE HOVER - FIXED)
           ========================================================================== 
        */
        
        /* Container Card: Gi·ªØ n·ªôi dung b√™n trong, bo g√≥c */
        .n-card {
            flex: 0 0 calc(25% - 15px); /* PC: 4 card/h√†ng */
            position: relative; 
            aspect-ratio: 16/9; 
            border-radius: 12px; 
            overflow: hidden; /* C·∫Øt ph·∫ßn th·ª´a khi zoom */
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
            background: #1a1c24;
            z-index: 1;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        /* Hover: Ph√≥ng to nh·∫π to√†n b·ªô card */
        .n-card:hover {
            transform: scale(1.05);
            z-index: 10;
            box-shadow: 0 15px 30px rgba(0,0,0,0.6);
            border: 1px solid rgba(255,255,255,0.2);
        }

        /* ·∫¢nh Poster */
        .n-poster { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            transition: 0.4s;
        }

        /* Hover: ·∫¢nh t·ªëi ƒëi v√† zoom nh·∫π b√™n trong */
        .n-card:hover .n-poster {
            filter: brightness(0.6);
            transform: scale(1.1); 
        }

        /* ƒêi·ªÅu ch·ªânh Info Layer khi kh√¥ng c√≤n description */
        .n-info-layer {
            /* 1. Thay ƒë·ªïi quan tr·ªçng: Ph·ªß k√≠n 100% card */
            position: absolute; 
            inset: 0; 
            
            padding: 15px;
            
            /* 2. ƒê·∫©y n·ªôi dung xu·ªëng d∆∞·ªõi c√πng */
            display: flex; 
            flex-direction: column; 
            justify-content: flex-end; 
            gap: 8px;

            /* 3. Gradient ph·ªß full: ƒê·∫≠m ·ªü d∆∞·ªõi, m·ªù d·∫ßn l√™n tr√™n */
            background: linear-gradient(
                    to top, 
                    #0f111a 0%,                /* ƒêen ƒë·∫∑c ·ªü ƒë√°y ƒë·ªÉ gi·ªØ ch√¢n ch·ªØ */
                    rgba(15, 17, 26, 0.95) 40%, /* ƒê·∫≠m d·∫ßn l√™n gi·ªØa ƒë·ªÉ ƒë·ªçc text r√µ */
                    rgba(15, 17, 26, 0.6) 80%,  /* M·ªù ƒëi */
                    transparent 100%            /* Trong su·ªët ho√†n to√†n ·ªü tr√™n */
                );

            /* 4. Gi·∫•u ƒëi ph·∫ßn tr√™n, ch·ªâ l·ªô t√™n phim */
            transform: translateY(50%); 
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 10;
        }

        /* KHI HOVER: Tr∆∞·ª£t l√™n l·∫•p ƒë·∫ßy card */
        .n-card:hover .n-info-layer {
            transform: translateY(0);
        }

        /* ƒê·∫£m b·∫£o Meta info lu√¥n cƒÉn tr√°i */
        .n-meta-in { 
            display: flex; 
            align-items: center; 
            gap: 12px; /* Kho·∫£ng c√°ch gi·ªØa c√°c th·∫ª HD, NƒÉm... */
            justify-content: flex-start; /* CƒÉn tr√°i */
            font-size: 0.75rem; 
            color: #ccc; 
            opacity: 0; 
            transition: 0.3s; 
        }
        
        /* Tinh ch·ªânh t√™n phim: TƒÉng shadow ƒë·ªÉ n·ªïi b·∫≠t tr√™n gradient m·ªõi */
        .n-title-in {
            font-size: 1rem;
            font-weight: 700;
            color: #fff;
            line-height: 1.3;
            /* Shadow m·ªÅm h∆°n nh∆∞ng ƒë·∫≠m h∆°n gi√∫p ch·ªØ n·ªïi kh·ªëi 3D */
            text-shadow: 0 2px 8px rgba(0,0,0,0.8); 
            margin-bottom: 2px;
            
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .n-card:hover .n-meta-in { opacity: 1; }

        /* H√†ng n√∫t b·∫•m (·∫®n khi ch∆∞a hover) */
        .n-actions-in {
            display: flex;
            gap: 10px;
            margin-top: 5px;
            opacity: 0;
            transition: 0.3s 0.1s;
        }
        .n-card:hover .n-actions-in { opacity: 1; }

        /* N√∫t Xem ngay nh·ªè */
        .btn-mini-play {
            flex: 1;
            background: var(--gradient-main);
            border: none;
            color: #fff;
            font-size: 0.8rem;
            font-weight: 700;
            padding: 8px;
            border-radius: 6px;
            display: flex; align-items: center; justify-content: center; gap: 6px;
            cursor: pointer;
        }
        .btn-mini-play:hover { filter: brightness(1.1); }

        /* N√∫t th√™m y√™u th√≠ch nh·ªè */
        .btn-mini-add {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.3s;
            font-size: 0.9rem;
        }

        .btn-mini-add:hover {
            background: #fff;
            color: #000; /* Hover v√†o chuy·ªÉn n·ªÅn tr·∫Øng ch·ªØ ƒëen */
            border-color: #fff;
            transform: scale(1.1);
        }

        /* Style ri√™ng cho n√∫t X√≥a kh·ªèi l·ªãch s·ª≠ */
        .btn-mini-remove {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            border-radius: 6px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: 0.3s;
        }
        /* Hover v√†o th√¨ chuy·ªÉn m√†u ƒë·ªè b√°o hi·ªáu x√≥a */
        .btn-mini-remove:hover { 
            background: #ff4757; 
            border-color: #ff4757; 
            color: #fff;
        }

        /* Mobile Adjustment */
        @media (max-width: 900px) {
            .n-card { flex: 0 0 160px; aspect-ratio: 2/3; } /* Mobile d√πng ·∫£nh d·ªçc */
            .n-info-layer { transform: translateY(0); padding: 10px; } /* Lu√¥n hi·ªán title */
            .n-meta-in, .n-actions-in { display: none; } /* ·∫®n n√∫t tr√™n mobile cho g·ªçn */
            .n-card:hover { transform: none; }
        }

        /* RESET PADDING GRID (Quan tr·ªçng):
           V√¨ card kh√¥ng c√≤n popup to ƒë√πng bay ra ngo√†i n·ªØa, 
           n√™n ta tr·∫£ padding c·ªßa Grid v·ªÅ b√¨nh th∆∞·ªùng cho ƒë·∫πp.
        */
        .country-grid {
            padding: 20px 5px !important;
            margin: 0 !important;
        }

        

        /* ====================
           TOP 5 TRENDING (UPDATED)
           ==================== */
        .top-10-wrapper { position: relative; z-index: 20; padding: 0 4% 80px; }
        .top-10-header { justify-content: space-between; align-items: left; margin-bottom: 25px; }
        .top-10-header h2 { font-size: 1.8rem; font-weight: 900; color: #fff; display: flex; align-items: center; gap: 15px; }
        .top-10-header h2 i { font-size: 1rem; width: 32px; height: 32px; border: 1px solid rgba(255,255,255,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #aaa; }
        .top-5-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 25px; }
        
        .top-card-style2 { position: relative; cursor: pointer; transition: 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); width: 100%; }
        
        /* Hi·ªáu ·ª©ng Hover Top 5: Bay l√™n & Lo√© s√°ng */
        .top-card-style2:hover { transform: translateY(-15px) scale(1.02); }
        
        .top-poster-style2 { 
            width: 100%; aspect-ratio: 2/3; border-radius: 18px; overflow: hidden; position: relative; 
            border: 2px solid transparent; /* Vi·ªÅn ch·ªù */
            transition: 0.4s;
            box-shadow: 0 15px 45px rgba(0,0,0,0.6);
        }

        /* Khi hover: Vi·ªÅn s√°ng + B√≥ng ƒë·ªï m√†u cam r·ª±c r·ª° */
        .top-card-style2:hover .top-poster-style2 {
            border-color: #ff8f50;
            box-shadow: 0 0 30px rgba(255, 143, 80, 0.6), 0 0 10px rgba(255, 255, 255, 0.5) inset;
        }

        .top-poster-style2 img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        
        .top-info-row { display: flex; align-items: flex-start; margin-top: 20px; }
        
            .top-rank-style2 { 
            font-size: 4.5rem; 
            /* FIX 1: TƒÉng line-height l√™n 1 ƒë·ªÉ hi·ªÉn th·ªã tr·ªçn v·∫πn s·ªë */
            line-height: 1; 
            font-family: 'Impact', sans-serif; 
            font-style: italic; 
            font-weight: 900; 
            background: linear-gradient(to bottom,  #FF5E62,#FF8F50, #FF5E62); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent;
            margin-right: 15px; 
            
            /* FIX 2: Th√™m padding ƒë·ªÉ b√≥ng ƒë·ªï v√† g√≥c nghi√™ng kh√¥ng b·ªã c·∫Øt */
            padding-right: 10px; 
            padding-bottom: 5px;
            
            filter: drop-shadow(2px 4px 0px rgba(0,0,0,0.5));
            
            /* ƒê·∫£m b·∫£o kh·ªëi s·ªë kh√¥ng b·ªã co l·∫°i */
            flex-shrink: 0;
        }
        
        .top-text-style2 { flex: 1; padding-top: 5px; }
        .top-title-style2 { font-size: 1.1rem; font-weight: 800; color: #fff; margin-bottom: 6px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.3; }
        .top-meta-style2 { font-size: 0.85rem; color: #aaa; font-weight: 600; display: flex; gap: 10px; }
        .top-meta-badge { background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 4px; color: #fff; font-size: 0.7rem; }

/* =========================================
   FOOTER REDESIGN (WIBUPHIM x WIBUPAD STYLE)
   ========================================= */
footer {
    background: #0b0c12; /* M√†u n·ªÅn t·ªëi h∆°n body m·ªôt ch√∫t ƒë·ªÉ t√°ch bi·ªát */
    border-top: 1px solid rgba(255, 255, 255, 0.05);
    padding: 80px 4% 30px;
    margin-top: 80px;
    position: relative;
    z-index: 100;
}

.footer-grid {
    display: grid;
    grid-template-columns: 1.5fr 1fr 1fr 1.2fr; /* C·ªôt Logo v√† Download to h∆°n ch√∫t */
    gap: 40px;
    margin-bottom: 50px;
}

/* --- C·ªôt 1: Brand --- */
.footer-logo {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 20px;
}

.footer-logo img {
    height: 45px;
    width: auto;
    object-fit: contain;
}

.footer-logo .brand-text {
    font-size: 1.6rem;
    font-weight: 900;
    letter-spacing: 1px;
    text-transform: uppercase;
}

.footer-desc {
    color: var(--text-sub);
    line-height: 1.6;
    font-size: 0.95rem;
    margin-bottom: 25px;
    max-width: 90%;
}

.footer-socials {
    display: flex;
    gap: 12px;
}

.social-link {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #ccc;
    transition: 0.3s;
    text-decoration: none;
    font-size: 1.1rem;
}

.social-link:hover {
    background: var(--gradient-main);
    color: #fff;
    border-color: transparent;
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(255, 94, 98, 0.3);
}

/* --- C√°c c·ªôt Link --- */
.footer-col h4 {
    color: #fff;
    font-size: 1rem;
    font-weight: 800;
    margin-bottom: 25px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.footer-links {
    list-style: none;
    padding: 0;
}

.footer-links li {
    margin-bottom: 15px;
}

.footer-links a {
    color: var(--text-sub);
    text-decoration: none;
    transition: 0.3s;
    font-size: 0.95rem;
    display: block;
    font-weight: 500;
}

.footer-links a:hover {
    color: var(--primary-color);
    transform: translateX(5px);
}

/* --- C·ªôt 4: Download Buttons --- */
.download-group {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.btn-download-app {
    background: rgba(255, 255, 255, 0.03);
    color: #fff;
    border: 1px solid rgba(255, 255, 255, 0.1);
    padding: 10px 16px;
    border-radius: 10px;
    cursor: pointer;
    text-align: left;
    display: flex;
    align-items: center;
    gap: 12px;
    transition: all 0.3s ease;
    width: 100%;
    max-width: 220px;
}

.btn-download-app i {
    font-size: 1.6rem;
    color: #ccc;
    transition: 0.3s;
}

.btn-content {
    line-height: 1.3;
}

.btn-small-text {
    font-size: 0.7rem;
    color: #888;
    display: block;
}

.btn-big-text {
    font-size: 1rem;
    font-weight: 700;
    color: #fff;
}

.btn-download-app:hover {
    border-color: var(--primary-color);
    background: rgba(255, 94, 98, 0.05);
    transform: translateY(-2px);
}

.btn-download-app:hover i {
    color: var(--primary-color);
}

/* --- Footer Bottom --- */
.footer-bottom {
    border-top: 1px solid rgba(255, 255, 255, 0.05);
    padding-top: 30px;
    text-align: center;
    color: #555;
    font-size: 0.85rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* --- Responsive Mobile --- */
@media (max-width: 900px) {
    .footer-grid {
        grid-template-columns: 1fr;
        gap: 40px;
        text-align: center;
    }

    .footer-logo, .footer-socials {
        justify-content: center;
    }

    .footer-desc {
        margin: 0 auto 25px;
    }

    .footer-col h4 {
        margin-bottom: 15px;
    }
    
    .download-group {
        align-items: center;
    }
    
    .footer-bottom {
        flex-direction: column;
        gap: 10px;
    }
}
        
        .modal { display: none; position: fixed; inset: 0; z-index: 2000; background: rgba(15, 17, 26, 0.95); padding: 40px; overflow-y: auto; }
        .modal.active { display: block; }
        .modal-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; }
        .modal-grid .movie-card { width: 100%; height: 280px; }

        /* Responsive Mobile */
        @media (max-width: 900px) {
            .footer-grid { grid-template-columns: 1fr; gap: 40px; text-align: center; }
            .footer-col ul { display: flex; flex-direction: column; align-items: center; }
            .footer-brand { justify-content: center; }
            .hero-title { font-size: 3rem; }
            .topic-grid { display: flex; overflow-x: auto; scrollbar-width: none; }
            .topic-card { flex: 0 0 160px; height: 95px; }
            
            .merged-block { padding: 35px 20px; border-radius: 0; margin: 0 0 40px; overflow: hidden !important; }
            /* Mobile Grid Adjustment */
            .country-grid { 
                padding: 40px 30px !important; 
                margin: -30px -30px !important; 
                gap: 15px; 
            }
            .n-card { flex: 0 0 260px; }
            .nav-arrow { display: none; } 
            .top-10-header h2 { font-size: 2rem; }
            .top-5-grid { display: flex !important; flex-wrap: nowrap !important; overflow-x: auto !important; gap: 15px; padding-bottom: 20px; scrollbar-width: none; }
            .top-card-style2 { flex: 0 0 160px; }
            .top-rank-style2 { font-size: 3.2rem !important; }
            .modal-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }
        }

        /* N√∫t xo√° l·ªãch s·ª≠ */
        .btn-remove-history {
            position: absolute; top: 10px; right: 10px; width: 28px; height: 28px;
            border-radius: 50%; background: rgba(255, 255, 255, 0.1); border: 1.5px solid rgba(255, 255, 255, 0.2);
            color: #fff; display: flex; align-items: center; justify-content: center;
            cursor: pointer; z-index: 100; transition: 0.3s; font-size: 0.8rem;
        }
        .btn-remove-history:hover { background: #ff4757; border-color: transparent; transform: scale(1.1); }


        /* CSS cho k·∫øt qu·∫£ t√¨m ki·∫øm */
        .search-result-item {
            display: flex;
            gap: 15px;
            padding: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
            transition: 0.2s;
        }
        .search-result-item:hover {
            background: rgba(255,255,255,0.05);
        }
        .search-result-item img {
            width: 50px;
            height: 75px;
            object-fit: cover;
            border-radius: 4px;
        }
        .search-result-info {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .search-result-title {
            color: #fff;
            font-weight: 700;
            font-size: 0.95rem;
            margin-bottom: 4px;
        }
        .search-result-meta {
            color: #a0a0a0;
            font-size: 0.8rem;
        }

        /* Container k·∫øt qu·∫£ Desktop (Th√™m c√°i n√†y ƒë·ªÉ Desktop c≈©ng hi·ªán k·∫øt qu·∫£) */
        #desktopSearchResults {
            position: absolute;
            top: 100%;
            right: 0;
            width: 350px;
            background: #1f212d;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            max-height: 400px;
            overflow-y: auto;
            display: none; /* M·∫∑c ƒë·ªãnh ·∫©n */
            z-index: 10002;
            margin-top: 10px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        #desktopSearchResults.active { display: block; }

        #desktopSearchResults::-webkit-scrollbar { width: 5px; }
        #desktopSearchResults::-webkit-scrollbar-thumb { background: #444; border-radius: 10px; }

       /* --- PANEL QU·∫¢NG C√ÅO (ƒê√É CH·ªàNH 1456x180) --- */
        .ad-panel-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin: 0 auto 40px;
            padding: 0 4%;
            width: 100%;
            /* üëâ S·ª¨A: TƒÉng ƒë·ªô r·ªông t·ªëi ƒëa l√™n 1456px */
            max-width: 1456px; 
        }

        .ad-link {
            display: block;
            width: 100%;
            /* üëâ S·ª¨A: TƒÉng ƒë·ªô r·ªông t·ªëi ƒëa l√™n 1456px */
            max-width: 1056px; 
        }

        .ad-img-728 {
            width: 100%;
            /* üëâ S·ª¨A: ƒê·ªÉ height l√† auto ƒë·ªÉ n√≥ t·ª± co gi√£n theo t·ªâ l·ªá */
            height: auto; 
            
            /* üëâ QUAN TR·ªåNG: Thi·∫øt l·∫≠p t·ªâ l·ªá khung h√¨nh chu·∫©n 1456/180 
               Gi√∫p ·∫£nh lu√¥n gi·ªØ ƒë√∫ng t·ªâ l·ªá d√π ·ªü m√†n h√¨nh to hay nh·ªè */
            aspect-ratio: 1456 / 180;

            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            display: block;
        }

        /* --- T·ª± ƒë·ªông co gi√£n tr√™n ƒêi·ªán tho·∫°i (Mobile) --- */
        @media (max-width: 768px) {
            .ad-img-728 {
                height: auto;
                /* üëâ S·ª¨A: C·∫≠p nh·∫≠t t·ªâ l·ªá cho mobile c≈©ng theo k√≠ch th∆∞·ªõc m·ªõi */
                aspect-ratio: 1456 / 180; 
            }
        }

        /* --- T·ª± ƒë·ªông co gi√£n tr√™n ƒêi·ªán tho·∫°i (Mobile) --- */
        @media (max-width: 768px) {
            .ad-img-728 {
                height: auto; /* Tr√™n ƒëi·ªán tho·∫°i ƒë·ªÉ auto cho ·∫£nh t·ª± thu nh·ªè */
                
                /* üëâ QUAN TR·ªåNG: N·∫øu ·ªü tr√™n b·∫°n ƒë·ªïi k√≠ch th∆∞·ªõc th√†nh R·ªông 1000px, Cao 200px 
                Th√¨ ·ªü ƒë√¢y b·∫°n s·ª≠a th√†nh: aspect-ratio: 1000/200; ƒë·ªÉ tr√™n mobile ko b·ªã m√©o */
                aspect-ratio: 728/90; 
            }
        }

        /* --- MEDIA QUERY: MAX 900PX (TABLET & MOBILE) --- */
        @media (max-width: 900px) {
            header { height: 65px; padding: 0 15px; justify-content: space-between; background: var(--bg-dark); }
            /* ·∫®n Desktop UI */
            .header-left-group, .nav-links, .search-box, .desktop-auth { display: none !important; }
            
            /* Hi·ªán Mobile UI */
            .mobile-left-container { display: flex !important; }
            .mobile-left-container .logo { position: static; transform: none; margin: 0; }
            .mobile-left-container .logo img { height: 32px; }
            .mobile-left-container .logo-text { font-size: 1.2rem; }
            .mobile-search-trigger { display: block !important; }

            /* --- MOBILE MENU STYLES (NEW) --- */
            .menu-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
            .menu-logo { display: flex; align-items: center; gap: 10px; } 
            .menu-logo img { height: 35px; } 
            .menu-logo span { font-weight: 800; font-size: 1.2rem; background: var(--gradient-main); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
            
            /* N√∫t Th√†nh vi√™n To m√†u cam */
            .member-btn-large { width: 100%; padding: 12px; background: var(--gradient-main); color: #fff; border: none; border-radius: 8px; font-weight: 700; font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 25px; cursor: pointer; box-shadow: 0 5px 15px rgba(255, 94, 98, 0.4); }
            
            /* Danh s√°ch menu */
            .mobile-menu-grid { display: flex; flex-direction: column; gap: 5px; max-height: 80vh; overflow-y: auto; }
            .mobile-menu-link { color: #ccc; text-decoration: none; font-weight: 600; font-size: 1rem; padding: 12px 0; display: flex; align-items: center; gap: 15px; border-bottom: 1px solid var(--mobile-border); }
            .mobile-menu-link i { width: 25px; color: var(--primary-color); text-align: center; }

            /* --- MOBILE SEARCH OVERLAY STYLES (NEW) --- */
            .search-header-mobile { display: flex; align-items: center; padding: 15px 20px; background: #2a2d3a; border-bottom: 1px solid rgba(255,255,255,0.1); }
            .search-input-mobile { flex: 1; background: transparent; border: none; color: #fff; font-size: 1rem; font-family: var(--font-main); margin-right: 15px; }
            .search-content-mobile { padding: 10px; }
            /* ƒê·ªãnh v·ªã n√∫t ƒë√≥ng */
            .close-btn-overlay { position: static !important; } 

            /* --- CONTENT ADJUSTMENTS --- */
            .hero-title { font-size: 3rem; }
            .topic-grid { display: flex; overflow-x: auto; scrollbar-width: none; }
            .topic-card { flex: 0 0 160px; height: 95px; }
            
            .merged-block { padding: 35px 20px; border-radius: 0; margin: 0 0 40px; overflow: hidden !important; }
            
            /* Grid phim ngang */
            .country-grid { padding: 40px 30px !important; margin: -30px -30px !important; gap: 15px; }
            .n-card { flex: 0 0 160px; aspect-ratio: 2/3; }
            .n-info-layer { transform: translateY(0); padding: 10px; }
            .n-meta-in, .n-actions-in { display: none; }
            .n-card:hover { transform: none; }
            .nav-arrow { display: none; } 

            .top-10-header h2 { font-size: 2rem; }
            .top-5-grid { display: flex !important; flex-wrap: nowrap !important; overflow-x: auto !important; gap: 15px; padding-bottom: 20px; scrollbar-width: none; }
            .top-card-style2 { flex: 0 0 160px; }
            .top-rank-style2 { font-size: 3.2rem !important; }
            
            .modal-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }

            .footer-grid { grid-template-columns: 1fr; gap: 40px; text-align: center; }
            .footer-col ul { display: flex; flex-direction: column; align-items: center; }
            .footer-brand { justify-content: center; }

            /* Mobile Ad Panel */
            .ad-img-728 { height: auto; aspect-ratio: 728/90; }
        }
        @media (min-width: 901px) { .episode-block-mobile { display: none; } }

        /* --- 1. QUY T·∫ÆC CHUNG CHO CARD PHIM (Standard & History) --- */
        .n-card img { width: 100%; height: 100%; object-fit: cover; transition: 0.4s; }

        /* PC: Card b√¨nh th∆∞·ªùng v√† Xem ti·∫øp ƒë·ªÅu hi·ªán ·∫£nh NGANG */
        .n-poster-wide { display: block !important; }
        .n-poster-portrait { display: none !important; }

        /* --- 2. QUY T·∫ÆC RI√äNG CHO TOP 5 (LU√îN L√Ä ·∫¢NH D·ªåC) --- */
        .top-poster-style2 { aspect-ratio: 2/3 !important; }
        .top-poster-style2 img { display: block !important; }

        /* --- 3. ƒêI·ªÄU CH·ªàNH KHI XU·ªêNG MOBILE --- */
        @media (max-width: 900px) {
            /* Mobile: ·∫®n ·∫£nh ngang, hi·ªán ·∫£nh d·ªçc */
            .n-poster-wide { display: none !important; }
            .n-poster-portrait { display: block !important; }
            
            .n-card {
                flex: 0 0 160px;
                aspect-ratio: 2/3 !important; /* Chuy·ªÉn khung card sang d·ªçc */
            }
        }

        /* =========================================
        CINEMA SLIDER (SCROLLABLE)
        ========================================= */
        .cinema-section { padding: 0 4%; margin-bottom: 60px; position: relative; z-index: 20; }

        .cinema-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .cinema-header h2 { font-size: 1.8rem; font-weight: 900; color: #fff; display: flex; align-items: center; gap: 15px; }
        .cinema-header h2 i { font-size: 1rem; width: 32px; height: 32px; border: 1px solid rgba(255,255,255,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #aaa; }

        /* N√∫t ƒëi·ªÅu h∆∞·ªõng Tr√°i/Ph·∫£i */
        .cinema-nav { display: flex; gap: 10px; }
        .cinema-nav button {
            width: 40px; height: 40px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.2);
            background: rgba(0,0,0,0.5); color: #fff; cursor: pointer; transition: 0.3s;
        }
        .cinema-nav button:hover { background: #ff8f50; border-color: transparent; }

        /* --- SLIDER CONTAINER --- */
        .cinema-grid {
            display: flex; /* Chuy·ªÉn t·ª´ Grid sang Flex ƒë·ªÉ tr∆∞·ª£t */
            flex-wrap: nowrap; /* Kh√¥ng xu·ªëng d√≤ng */
            gap: 20px;
            overflow-x: auto; /* Cho ph√©p cu·ªôn ngang */
            scroll-behavior: smooth;
            scrollbar-width: none; /* ·∫®n thanh cu·ªôn Firefox */
            
            /* V√πng ƒë·ªám ƒë·ªÉ card hover kh√¥ng b·ªã c·∫Øt (Quan tr·ªçng) */
            padding: 20px 5px; 
            margin: -20px -5px; 
        }
        .cinema-grid::-webkit-scrollbar { display: none; } /* ·∫®n thanh cu·ªôn Chrome/Safari */

        /* --- CARD STYLE (Gi·ªØ nguy√™n ƒë·∫πp, ch·ªânh k√≠ch th∆∞·ªõc) --- */
        .cinema-card {
            /* PC: Hi·ªán kho·∫£ng 3.2 phim ƒë·ªÉ ng∆∞·ªùi d√πng bi·∫øt c√≤n n·ªØa */
            flex: 0 0 32%; 
            position: relative; aspect-ratio: 16/9;
            border-radius: 12px; overflow: hidden; cursor: pointer;
            background: #1a1c24; border: 1px solid rgba(255,255,255,0.1);
            transition: 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .cinema-card:hover {
            transform: translateY(-15px) scale(1.02);
            border-color: #ff8f50;
            box-shadow: 0 0 30px rgba(255, 143, 80, 0.6), 0 0 10px rgba(255, 255, 255, 0.5) inset;
        }
        /* Background & Content (Gi·ªØ nguy√™n logic c≈©) */
        .cinema-bg { width: 100%; height: 100%; position: absolute; inset: 0; }
        .cinema-bg img { width: 100%; height: 100%; object-fit: cover; opacity: 0.6; transition: 0.5s; }
        .cinema-card:hover .cinema-bg img { transform: scale(1.1); opacity: 0.4; filter: blur(2px); }

        .cinema-overlay { position: absolute; inset: 0; background: linear-gradient(to top, #000 10%, rgba(0,0,0,0.8) 40%, transparent 100%); }

        .cinema-content { position: absolute; bottom: 0; left: 0; width: 100%; padding: 15px; display: flex; align-items: flex-end; gap: 15px; z-index: 2; }

        .cinema-poster-mini {
            width: 75px; aspect-ratio: 2/3; flex-shrink: 0;
            border-radius: 6px; overflow: hidden;
            border: 2px solid rgba(255,255,255,0.8);
            box-shadow: 0 5px 15px rgba(0,0,0,0.8);
        }
        .cinema-poster-mini img { width: 100%; height: 100%; object-fit: cover; }

        .cinema-info { flex: 1; display: flex; flex-direction: column; gap: 2px; }
        .cinema-title-vi { font-size: 1rem; font-weight: 800; color: #fff; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; text-shadow: 1px 1px 2px #000; }
        .cinema-title-en { font-size: 0.8rem; color: #ccc; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; }
        .cinema-meta { font-size: 0.75rem; color: #FF8F50; font-weight: 700; margin-top: 4px; }

        /* --- MOBILE RESPONSIVE --- */
        @media (max-width: 900px) {
            .cinema-nav { display: none; } /* ·∫®n n√∫t b·∫•m tr√™n mobile */
            .cinema-card { 
                flex: 0 0 85%; /* Mobile: Hi·ªán 1 card r∆∞·ª°i ƒë·ªÉ k√≠ch th√≠ch vu·ªët */
                aspect-ratio: 16/9;
            }
            .cinema-grid { gap: 15px; padding-left: 15px; padding-right: 15px; } /* CƒÉn l·ªÅ tr√°i ph·∫£i cho ƒë·∫πp */
        }

/* =========================================
   FACEBOOK COMMUNITY CARD (WIDE VERSION)
   ========================================= */
.community-section {
    /* 1. CH·ªàNH CHI·ªÄU R·ªòNG (NGANG) */
    width: 100%;
    max-width: 100%; /* ƒê·ªÉ 100% cho n√≥ d√†i h·∫øt c·ª° (ho·∫∑c 1600px n·∫øu mu·ªën gi·ªõi h·∫°n) */
    margin: 0 auto 60px;
    padding: 0 4%; /* Kho·∫£ng c√°ch l·ªÅ 2 b√™n */
}

.comm-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(105deg, #1877F2 0%, #0f111a 60%);
    
    /* 2. CH·ªàNH CHI·ªÄU CAO (ƒê·ªò D√ÄY) */
    /* TƒÉng padding l√™n: 45px (tr√™n d∆∞·ªõi) 60px (tr√°i ph·∫£i) */
    padding: 36px 60px; 
    
    border-radius: 24px;
    text-decoration: none;
    position: relative;
    overflow: hidden;
    box-shadow: 0 15px 40px rgba(24, 119, 242, 0.25);
    border: 1px solid rgba(255,255,255,0.1);
    transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
}

/* Hi·ªáu ·ª©ng Hover */
.comm-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 25px 80px rgba(24, 119, 242, 0.5); /* B√≥ng ƒë·ªï m·∫°nh h∆°n cho ng·∫ßu */
    border-color: rgba(255,255,255,0.3);
}

/* Ph·∫ßn b√™n tr√°i: Icon + Text */
.comm-left {
    display: flex;
    align-items: center;
    gap: 30px; /* TƒÉng kho·∫£ng c√°ch icon v√† ch·ªØ */
    z-index: 2;
}

.comm-icon {
    width: 70px; height: 70px; /* Icon to h∆°n x√≠u */
    background: #fff;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 2.5rem; color: #1877F2;
    box-shadow: 0 0 25px rgba(255,255,255,0.4);
}

.comm-title {
    font-size: 1.8rem; /* Ch·ªØ to h∆°n */
    font-weight: 900;
    color: #fff;
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.comm-desc {
    font-size: 1.1rem; /* M√¥ t·∫£ r√µ h∆°n */
    color: rgba(255,255,255,0.9);
    font-weight: 500;
}

/* Ph·∫ßn b√™n ph·∫£i: N√∫t tham gia */
.comm-btn {
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.3);
    color: #fff;
    padding: 15px 35px; /* N√∫t to h∆°n */
    border-radius: 50px;
    font-weight: 800;
    font-size: 1rem;
    display: flex; align-items: center; gap: 12px;
    transition: 0.3s;
    z-index: 2;
    white-space: nowrap; /* Gi·ªØ n√∫t kh√¥ng b·ªã xu·ªëng d√≤ng */
}

.comm-card:hover .comm-btn {
    background: #fff;
    color: #1877F2;
    box-shadow: 0 0 20px rgba(255,255,255,0.5);
}

/* H√¨nh n·ªÅn trang tr√≠ */
.comm-bg-deco {
    position: absolute;
    right: -20px; top: -60%;
    font-size: 18rem; /* Icon n·ªÅn to h∆°n */
    color: rgba(255,255,255,0.05);
    transform: rotate(15deg);
    pointer-events: none;
    transition: 0.4s;
}
.comm-card:hover .comm-bg-deco {
    transform: rotate(0deg) scale(1.1);
    color: rgba(255,255,255,0.1);
}

/* Mobile Responsive (Gi·ªØ nguy√™n cho ƒëi·ªán tho·∫°i kh√¥ng b·ªã v·ª°) */
@media (max-width: 768px) {
    .comm-card {
        flex-direction: column;
        text-align: center;
        padding: 30px 20px;
        gap: 20px;
    }
    .comm-left { flex-direction: column; gap: 15px; }
    .comm-bg-deco { font-size: 10rem; top: 10%; right: -20%; }
    .comm-btn { width: 100%; justify-content: center; }
    .comm-title { font-size: 1.5rem; }
}

/* Style huy hi·ªáu s·ªë d∆∞ c·∫°nh t√™n */
.balance-badge {
    background: rgba(255, 215, 0, 0.15);
    color: #FFD700;
    padding: 2px 10px;
    border-radius: 50px;
    font-size: 0.75rem;
    font-weight: 800;
    border: 1px solid rgba(255, 215, 0, 0.4);
    margin-left: 8px;
    display: inline-flex;
    align-items: center;
    gap: 4px;
    vertical-align: middle;
    text-transform: none;
}
.balance-badge i {
    font-size: 0.7rem;
    filter: drop-shadow(0 0 3px rgba(255, 215, 0, 0.6));
}

/* --- HI·ªÜU ·ª®NG VIP (KING STYLE) --- */
.vip-glow {
    border: 2px solid #FFD700 !important;
    box-shadow: 0 0 10px #FFD700, 0 0 20px rgba(255, 215, 0, 0.6) !important;
    animation: vipPulse 2s infinite;
}
.vip-name {
    background: linear-gradient(to right, #FFD700, #FFF5C3, #FFD700);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: 900 !important;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    display: inline-flex; align-items: center; gap: 5px;
}
@keyframes vipPulse {
    0% { box-shadow: 0 0 5px #FFD700; border-color: #FFD700; }
    50% { box-shadow: 0 0 20px #FFD700; border-color: #FFF5C3; }
    100% { box-shadow: 0 0 5px #FFD700; border-color: #FFD700; }
}
.vip-crown { display: inline-block; color: #FFD700; font-size: 0.8rem; transform: translateY(-2px); }
@keyframes pulseGold { 0% { box-shadow: 0 0 10px #FFD700; } 50% { box-shadow: 0 0 20px #FFD700; } 100% { box-shadow: 0 0 10px #FFD700; } }

/* --- 2. GIAO DI·ªÜN NHI·ªÜM V·ª§ (MODAL) --- */
.mission-item {
    display: flex; justify-content: space-between; align-items: center;
    background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px;
    margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.1);
}
.mission-info h4 { color: #fff; margin-bottom: 5px; font-size: 1rem; }
.mission-info p { color: #aaa; font-size: 0.85rem; }
.btn-mission {
    padding: 8px 20px; border-radius: 50px; border: none; font-weight: 700; cursor: pointer;
    background: var(--gradient-main); color: #fff; transition: 0.3s;
}
.btn-mission:disabled { background: #444; color: #888; cursor: not-allowed; }
.coin-reward { color: #FFD700; font-weight: 800; }


/* --- HI·ªÜU ·ª®NG VIP (KING STYLE) --- */
.vip-glow {
    border: 2px solid #FFD700 !important;
    box-shadow: 0 0 12px #FFD700, 0 0 20px rgba(255, 215, 0, 0.5) !important;
    animation: vipPulse 2s infinite !important;
    position: relative;
}

.vip-name {
    background: linear-gradient(to right, #FFD700, #FFF5C3, #FFD700);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: 900 !important;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    display: inline-flex;
    align-items: center;
    gap: 5px;
}

@keyframes vipPulse {
    0% { box-shadow: 0 0 5px #FFD700; border-color: #FFD700; }
    50% { box-shadow: 0 0 20px #FFD700; border-color: #FFF5C3; }
    100% { box-shadow: 0 0 5px #FFD700; border-color: #FFD700; }
}

/* Badge s·ªë d∆∞ */
.balance-badge {
    background: rgba(255, 215, 0, 0.15);
    color: #FFD700;
    padding: 2px 10px;
    border-radius: 50px;
    font-size: 0.75rem;
    font-weight: 800;
    border: 1px solid rgba(255, 215, 0, 0.4);
    margin-left: 8px;
    display: inline-flex;
    align-items: center;
    gap: 4px;
    vertical-align: middle;
}
.balance-badge i { font-size: 0.7rem; filter: drop-shadow(0 0 3px rgba(255, 215, 0, 0.6)); }

/* --- 3. B√åNH LU·∫¨N N·ªîI B·∫¨T CHO VIP --- */
.comment-item.is-vip .comment-avatar {
    border: 2px solid #FFD700;
    box-shadow: 0 0 10px #FFD700;
}
.comment-item.is-vip .comment-author {
    color: #FFD700 !important;
    text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
    display: inline-flex; align-items: center; gap: 5px;
}
.comment-item.is-vip .comment-text {
    background: linear-gradient(90deg, rgba(255, 215, 0, 0.1), transparent);
    border: 1px solid rgba(255, 215, 0, 0.3);
    color: #fff;
}

        /* =========================================
           SHORT DRAMA SECTION (SLIDER 7 ITEMS)
           ========================================= */
        .short-section { 
            padding: 0 4% 60px; 
            position: relative; 
            z-index: 20; 
        }

        .short-header {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;
        }
        .sh-title-group { display: flex; align-items: center; gap: 10px; }
        .short-header h2 { font-size: 1.8rem; font-weight: 900; color: #fff; display: flex; align-items: center; gap: 15px; }
        .short-header h2 i { font-size: 1rem; width: 32px; height: 32px; border: 1px solid rgba(255,255,255,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #aaa; }

        .short-nav-group { display: flex; align-items: center; gap: 20px; }
        .view-all-link { font-size: 0.9rem; color: #aaa; font-weight: 600; transition: 0.3s; }
        .view-all-link:hover { color: #ff8f50; }

        /* N√∫t ƒëi·ªÅu h∆∞·ªõng tr√≤n */
        .short-arrows { display: flex; gap: 10px; }
        .short-arrows button {
            width: 40px; height: 40px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.2);
            background: rgba(0,0,0,0.5); color: #fff; cursor: pointer; transition: 0.3s;
        }
        .short-arrows button:hover { background: #ff8f50; border-color: transparent; }

        /* CONTAINER SLIDER */
        .short-slider-wrapper {
            position: relative;
            margin: 0 -10px; /* B√π tr·ª´ padding c·ªßa card */
            overflow: hidden;
        }

        .short-grid { 
            display: flex; /* X·∫øp ngang */
            gap: 15px; 
            overflow-x: auto; 
            scroll-behavior: smooth;
            padding: 15px 10px; /* Padding ƒë·ªÉ shadow kh√¥ng b·ªã c·∫Øt */
            scrollbar-width: none; /* ·∫®n thanh cu·ªôn Firefox */
        }
        .short-grid::-webkit-scrollbar { display: none; } /* ·∫®n thanh cu·ªôn Chrome */

        /* CARD STYLE (D·ªåC, NH·ªé - 7 CARD/H√ÄNG) */
        .short-card {
            /* T√≠nh to√°n: (100% / 7) tr·ª´ ƒëi kho·∫£ng c√°ch gap */
            flex: 0 0 calc(14.28% - 13px); 
            
            position: relative; cursor: pointer; border-radius: 12px; overflow: hidden;
            aspect-ratio: 2/3;
            transition: 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            background: #1a1c24;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .short-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 25px rgba(255, 161, 94, 0.3);
            border-color: #FF8F50;
            z-index: 5;
        }

        .short-card img { width: 100%; height: 100%; object-fit: cover; transition: 0.4s; }
        .short-card:hover img { filter: brightness(0.6); transform: scale(1.1); }

        /* Th√¥ng tin ƒë√® l√™n ·∫£nh */
        .short-info {
            position: absolute; bottom: 0; left: 0; width: 100%;
            padding: 12px 8px;
            background: linear-gradient(to top, rgba(0,0,0,0.95) 10%, transparent);
            transform: translateY(10px); opacity: 0;
            transition: 0.3s;
            display: flex; flex-direction: column; justify-content: flex-end;
        }
        .short-card:hover .short-info { transform: translateY(0); opacity: 1; }

        .short-title {
            font-size: 0.8rem; font-weight: 700; color: #fff;
            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
            line-height: 1.3; margin-bottom: 4px; text-align: center;
        }
        .short-ep-badge {
            position: absolute; top: 8px; right: 8px;
            font-size: 0.6rem; color: #ffffff; font-weight: 800;
            background: #FF8F50; padding: 2px 6px; border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        /* RESPONSIVE */
        @media (max-width: 1600px) { .short-card { flex: 0 0 calc(16.66% - 13px); } } /* 6 c·ªôt */
        @media (max-width: 1400px) { .short-card { flex: 0 0 calc(20% - 12px); } } /* 5 c·ªôt */
        @media (max-width: 1024px) { .short-card { flex: 0 0 calc(25% - 12px); } } /* 4 c·ªôt */
        @media (max-width: 768px) {
            .short-arrows, .view-all-link { display: none; } /* Mobile ·∫©n n√∫t, vu·ªët tay */
            .short-header { margin-bottom: 10px; }
            .short-grid { gap: 10px; padding: 10px; }
            .short-card { flex: 0 0 130px; border-radius: 8px; } /* Mobile c·ªë ƒë·ªãnh px */
            .short-info { transform: translateY(0); opacity: 1; padding: 8px 5px; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); } /* Mobile lu√¥n hi·ªán info */
        }
    </style>
</head>
<body>

    <div id="loadingScreen">
        <img src="/Loading.png" class="loading-img" alt="WibuPhim">
    </div>

    <div id="toast-container"></div>

    <div id="confirmModal" class="custom-confirm-overlay">
        <div class="confirm-box">
            <div class="confirm-icon"><i class="fas fa-question-circle"></i></div>
            <h3 style="color:#fff; font-size:1.6rem; margin-bottom:12px;">X√°c nh·∫≠n</h3>
            <p id="confirmMsg" style="color:#888; font-size:1.05rem;">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën th·ª±c hi·ªán h√†nh ƒë·ªông n√†y?</p>
            <div class="confirm-actions" style="margin-top:25px;">
                <button class="btn-confirm btn-cancel" id="btnConfirmNo">H·ªßy b·ªè</button>
                <button class="btn-confirm btn-ok" id="btnConfirmYes">ƒê·ªìng √Ω</button>
            </div>
        </div>
    </div>

    <div id="modalPopup" class="modal">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:40px; border-bottom:1px solid #222; padding-bottom:20px;">
            <h2 id="modalTitle" class="text-gradient" style="font-size: 2rem;">Danh s√°ch phim</h2>
            <i class="fas fa-times" onclick="closeModal()" style="font-size:2.5rem; color:#fff; cursor:pointer;"></i>
        </div>
        <div id="modalContent" class="modal-grid"></div>
    </div>

    <div id="mobileMenuOverlay" class="mobile-overlay">
        <div class="backdrop" onclick="closeMobileMenu()"></div>
        <div id="mobileMenuContent" style="background: var(--mobile-menu-bg); width: 300px; height: 100%; display: flex; flex-direction: column; position: relative; z-index: 2; box-shadow: 20px 0 60px rgba(0,0,0,0.8); padding: 25px;">
            
            <div class="menu-header">
                <div class="menu-logo"><img src="/LOGO.WEBP" alt="WibuPhim"><span>WIBUPHIM</span></div>
                <i class="fas fa-times close-btn-overlay" onclick="closeMobileMenu()" style="font-size: 1.5rem; color: #fff; cursor: pointer;"></i>
            </div>

            <button class="member-btn-large" id="mobileMemberBtn" onclick="window.location.href='/login.html'">
                <i class="fas fa-user-circle"></i> <span id="mobileMemberText">ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</span>
            </button>

            <div class="mobile-menu-grid">
                <a href="/" class="mobile-menu-link" onclick="closeMobileMenu()"><i class="fas fa-home"></i> Trang ch·ªß</a>
                <a href="#" class="mobile-menu-link" onclick="loadCategory('phim-bo', 'Phim B·ªô'); closeMobileMenu()"><i class="fas fa-tv"></i> Phim B·ªô</a>
                <a href="#" class="mobile-menu-link" onclick="loadCategory('phim-le', 'Phim L·∫ª'); closeMobileMenu()"><i class="fas fa-film"></i> Phim L·∫ª</a>
                
                <div style="border-bottom: 1px solid var(--mobile-border); padding: 10px 0; color:#666; font-size:0.9rem; font-weight:700; text-transform:uppercase; margin-top:10px;">Qu·∫£n L√Ω</div>
                <a href="profile.html" class="mobile-menu-link" onclick="closeMobileMenu()"><i class="fas fa-user-cog"></i> T√†i Kho·∫£n</a>
                <div id="drawerLogout" class="mobile-menu-link" style="color:#ff4757; display:none; cursor: pointer;" onclick="logout()"><i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t</div>
            </div>
        </div>
    </div>

    <div id="mobileSearchOverlay" class="mobile-overlay">
        <div class="search-header-mobile">
            <i class="fas fa-search" style="color: #a0a0a0; margin-right: 10px;"></i>
            <input type="text" id="mobileSearchInput" class="search-input-mobile" placeholder="Nh·∫≠p t√™n phim..." autocomplete="off">
            <i class="fas fa-times close-btn-overlay" onclick="closeMobileSearch()" style="font-size: 1.5rem; color: #fff; cursor: pointer;"></i>
        </div>
        <div class="search-content-mobile" style="padding: 10px; height: calc(100% - 60px); overflow-y: auto;">
            <div id="mobileSearchResults"></div>
        </div>
    </div>

    <header id="siteHeader">
        <div class="mobile-left-container">
            <i class="fas fa-bars mobile-menu-toggle" onclick="openMobileMenu()"></i>
            <div class="logo" onclick="loadHome()">
                <img src="/LOGO.WEBP" alt="Logo"><span class="logo-text">WIBUPHIM</span>
            </div>
        </div>

        <div class="header-left-group">
            <div class="logo" onclick="loadHome()">
                <img src="/LOGO.WEBP" alt="Logo"><span class="logo-text text-gradient">WIBUPHIM</span>
            </div>
            <ul class="nav-links" id="navLinks">
                <li class="nav-item">
                    <a href="/" class="nav-link">Trang ch·ªß</a>
                </li>
                
                <li class="nav-item">
                    <div class="nav-link">Th·ªÉ lo·∫°i <i class="fas fa-caret-down"></i></div>
                    <div class="dropdown-menu">
                        <div class="dropdown-grid">
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('hanh-dong', 'H√†nh ƒê·ªông')">H√†nh ƒê·ªông</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('tinh-cam', 'T√¨nh C·∫£m')">T√¨nh C·∫£m</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('hai-huoc', 'H√†i H∆∞·ªõc')">H√†i H∆∞·ªõc</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('co-trang', 'C·ªï Trang')">C·ªï Trang</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('tam-ly', 'T√¢m L√Ω')">T√¢m L√Ω</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('hinh-su', 'H√¨nh S·ª±')">H√¨nh S·ª±</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('chien-tranh', 'Chi·∫øn Tranh')">Chi·∫øn Tranh</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('the-thao', 'Th·ªÉ Thao')">Th·ªÉ Thao</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('vo-thuat', 'V√µ Thu·∫≠t')">V√µ Thu·∫≠t</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('vien-tuong', 'Vi·ªÖn T∆∞·ªüng')">Vi·ªÖn T∆∞·ªüng</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('phieu-luu', 'Phi√™u L∆∞u')">Phi√™u L∆∞u</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('khoa-hoc', 'Khoa H·ªçc')">Khoa H·ªçc</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('kinh-di', 'Kinh D·ªã')">Kinh D·ªã</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('am-nhac', '√Çm Nh·∫°c')">√Çm Nh·∫°c</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('than-thoai', 'Th·∫ßn Tho·∫°i')">Th·∫ßn Tho·∫°i</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('tai-lieu', 'T√†i Li·ªáu')">T√†i Li·ªáu</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('gia-dinh', 'Gia ƒê√¨nh')">Gia ƒê√¨nh</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('hoc-duong', 'H·ªçc ƒê∆∞·ªùng')">H·ªçc ƒê∆∞·ªùng</a>
                            <a href="#" class="dropdown-item-link" onclick="loadCategory('short-drama', 'Short Drama')">Short Drama</a>
                        </div>
                    </div>
                </li>

                <li class="nav-item"><a href="#" class="nav-link" onclick="loadCategory('phim-le', 'Phim L·∫ª')">Phim L·∫ª</a></li>
                <li class="nav-item"><a href="#" class="nav-link" onclick="loadCategory('phim-bo', 'Phim B·ªô')">Phim B·ªô</a></li>

                <li class="nav-item">
                    <div class="nav-link">Qu·ªëc gia <i class="fas fa-caret-down"></i></div>
                    <div class="dropdown-menu" style="width: 400px;">
                        <div class="dropdown-grid" style="grid-template-columns: repeat(3, 1fr);">
                            <a href="#" class="dropdown-item-link" onclick="openModal('trung-quoc', 'Phim Trung Qu·ªëc')">Trung Qu·ªëc</a>
                            <a href="#" class="dropdown-item-link" onclick="openModal('han-quoc', 'Phim H√†n Qu·ªëc')">H√†n Qu·ªëc</a>
                            <a href="#" class="dropdown-item-link" onclick="openModal('nhat-ban', 'Phim Nh·∫≠t B·∫£n')">Nh·∫≠t B·∫£n</a>
                            <a href="#" class="dropdown-item-link" onclick="openModal('thai-lan', 'Phim Th√°i Lan')">Th√°i Lan</a>
                            <a href="#" class="dropdown-item-link" onclick="openModal('au-my', 'Phim √Çu M·ªπ')">√Çu M·ªπ</a>
                            <a href="#" class="dropdown-item-link" onclick="openModal('dai-loan', 'Phim ƒê√†i Loan')">ƒê√†i Loan</a>
                            <a href="#" class="dropdown-item-link" onclick="openModal('hong-kong', 'Phim H·ªìng K√¥ng')">H·ªìng K√¥ng</a>
                            <a href="#" class="dropdown-item-link" onclick="openModal('an-do', 'Phim ·∫§n ƒê·ªô')">·∫§n ƒê·ªô</a>
                            <a href="#" class="dropdown-item-link" onclick="openModal('viet-nam', 'Phim Vi·ªát Nam')">Vi·ªát Nam</a>
                        </div>
                    </div>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="https://wibuteam.netlify.app" target="_blank">V·ªÅ WibuTeam</a>
                </li>
            </ul>
        </div>
        <div class="right-elements">
            <div class="mobile-search-trigger" onclick="openMobileSearch()"><i class="fas fa-search"></i></div>
            
            <div class="search-box desktop-auth" style="position: relative;"> 
                <i class="fas fa-search" style="color: #a0a0a0"></i>
                <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm phim..." autocomplete="off">
                <div id="desktopSearchResults"></div>
            </div>

            <div class="desktop-auth" style="position: relative;">
                <button id="btnLogin" class="btn-login" onclick="window.location.href='/login.html'">ƒêƒÉng nh·∫≠p</button>
                <img id="userAvatar" class="user-avatar" src="" alt="User" onclick="toggleUserDropdown()">
                <div id="userMenu" class="user-dropdown">
                    <div id="userNameDisplay" class="user-info-item">User</div>
                    
                    <div id="vipStatus" style="padding: 10px; font-size: 0.8rem; color: #aaa; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <i class="fas fa-crown"></i> Free Plan
                    </div>

                    <button class="dropdown-item" onclick="window.buyVipPackage()">
                        <i class="fas fa-star" style="color: #FFD700;"></i> Mua VIP
                    </button>

                    <button class="dropdown-item" onclick="window.location.href='/nap-coin.html'"><i class="fa-duotone fa-solid fa-wallet"></i> N·∫°p Coin</button>
                    <button class="dropdown-item" onclick="window.location.href='/profile.html'"><i class="fas fa-user-cog"></i> T√†i kho·∫£n</button>
                    <button class="dropdown-item" onclick="logout()"><i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t</button>
                </div>
            </div>
        </div>
    </header>

    <div class="hero-wrapper" id="heroWrapper">
        <div class="hero-overlay"></div>
        
        <div class="hero-fog"></div>

        <div id="heroSlidesContainer"></div>
        
        <div class="hero-thumbnails" id="heroThumbnails"></div>
    </div>

    <div class="topics-section">
        <div class="section-label">G·ª£i √Ω ch·ªß ƒë·ªÅ</div>
        <div class="topic-grid">
            <div class="topic-card bg-marvel" onclick="loadCategory('hanh-dong', 'Marvel')"><i class="fab fa-quinscape floating-icon"></i><div class="topic-name">Marvel</div><div class="topic-link">Xem ngay <i class="fas fa-arrow-right"></i></div></div>
            <div class="topic-card bg-sitcom" onclick="loadCategory('hai-huoc', 'Sitcom')"><i class="fas fa-laugh-squint floating-icon"></i><div class="topic-name">Sitcom</div><div class="topic-link">Xem ngay <i class="fas fa-arrow-right"></i></div></div>
            <div class="topic-card bg-voice" onclick="loadCategory('short-drama', 'Short Drama')"><i class="fas fa-torii-gate floating-icon"></i><div class="topic-name">Short Drama</div><div class="topic-link">Xem ngay <i class="fas fa-arrow-right"></i></div></div>
            <div class="topic-card bg-trans" onclick="loadCategory('tam-ly', 'T√¢m L√Ω')"><i class="fas fa-film floating-icon"></i><div class="topic-name">T√¢m L√Ω</div><div class="topic-link">Xem ngay <i class="fas fa-arrow-right"></i></div></div>
            <div class="topic-card bg-ancient" onclick="loadCategory('co-trang', 'C·ªï Trang')"><i class="fas fa-dragon floating-icon"></i><div class="topic-name">C·ªï Trang</div><div class="topic-link">Xem ngay <i class="fas fa-arrow-right"></i></div></div>
            <div class="topic-card bg-4k" onclick="loadCategory('kinh-di', 'Kinh D·ªã')"><i class="fas fa-ghost floating-icon"></i><div class="topic-name">Kinh D·ªã</div><div class="topic-link">Xem ngay <i class="fas fa-arrow-right"></i></div></div>
        </div>
    </div>

<div class="community-section">
    <a href="https://www.facebook.com/groups/1165263735526384/" target="_blank" class="comm-card">
        <i class="fab fa-facebook comm-bg-deco"></i>
        
        <div class="comm-left">
            <div class="comm-icon">
                <i class="fab fa-facebook-f"></i>
            </div>
            <div class="comm-info">
                <div class="comm-title">C·ªông ƒê·ªìng WibuTeam</div>
                <div class="comm-desc">Tham gia Group Facebook ƒë·ªÉ y√™u c·∫ßu phim, b√°o l·ªói v√† ch√©m gi√≥ c√πng admin!</div>
            </div>
        </div>
        
        <div class="comm-btn">
            Tham Gia Ngay <i class="fas fa-arrow-right"></i>
        </div>
    </a>
</div>

    <div class="ad-panel-wrapper">
        <a href="https://wibuphim.netlify.app" target="_blank" class="ad-link">
            <img src="https://wibuphim.netlify.app/WIBUPHIMADS.PNG" alt="Qu·∫£ng c√°o" class="ad-img-728">
        </a>
    </div>

    <div id="history-container"></div>

    <main id="main-content">
        <div class="merged-block">
            <div class="country-section">
                <div class="country-header"><div class="ch-title">Phim <span class="text-gradient">H√†n Qu·ªëc</span></div><div class="ch-link" onclick="openModal('han-quoc', 'Phim H√†n Qu·ªëc')">Xem to√†n b·ªô <i class="fas fa-chevron-right"></i></div></div>
                <div class="grid-wrapper">
                    <button class="nav-arrow arrow-prev" onclick="scrollGrid('koreaList', -1)"><i class="fas fa-chevron-left"></i></button>
                    <div class="country-grid" id="koreaList"></div>
                    <button class="nav-arrow arrow-next" onclick="scrollGrid('koreaList', 1)"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
            <div class="country-section">
                <div class="country-header"><div class="ch-title">Phim <span class="text-gradient">Trung Qu·ªëc</span></div><div class="ch-link" onclick="openModal('trung-quoc', 'Phim Trung Qu·ªëc')">Xem to√†n b·ªô <i class="fas fa-chevron-right"></i></div></div>
                <div class="grid-wrapper">
                    <button class="nav-arrow arrow-prev" onclick="scrollGrid('chinaList', -1)"><i class="fas fa-chevron-left"></i></button>
                    <div class="country-grid" id="chinaList"></div>
                    <button class="nav-arrow arrow-next" onclick="scrollGrid('chinaList', 1)"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
            <div class="country-section">
                <div class="country-header"><div class="ch-title">Phim <span class="text-gradient">Th√°i Lan</span></div><div class="ch-link" onclick="openModal('thai-lan', 'Phim Th√°i Lan')">Xem to√†n b·ªô <i class="fas fa-chevron-right"></i></div></div>
                <div class="grid-wrapper">
                    <button class="nav-arrow arrow-prev" onclick="scrollGrid('thaiList', -1)"><i class="fas fa-chevron-left"></i></button>
                    <div class="country-grid" id="thaiList"></div>
                    <button class="nav-arrow arrow-next" onclick="scrollGrid('thaiList', 1)"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
    </main>

    <div class="ad-panel-wrapper">
        <a href="https://wibuanime.netlify.app" target="_blank" class="ad-link">
            <img src="https://wibuphim.netlify.app/WIBUANIMEADS.PNG" alt="Qu·∫£ng c√°o" class="ad-img-728">
        </a>
    </div>

    <section class="short-section">
        <div class="short-header">
            <div class="sh-title-group">
                <h2>Short Drama<i class="fas fa-chevron-right"></i></h2>
            </div>
            
            <div class="short-nav-group">
                <a href="#" onclick="loadCategory('short-drama', 'Short Drama')" class="view-all-link">Xem t·∫•t c·∫£</a>
                <div class="short-arrows">
                    <button onclick="scrollShorts(-1)"><i class="fas fa-chevron-left"></i></button>
                    <button onclick="scrollShorts(1)"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
        
        <div class="short-slider-wrapper">
            <div class="short-grid" id="shortDramaContainer">
                <div style="color:#888; padding: 20px;">ƒêang t·∫£i phim ng·∫Øn...</div>
            </div>
        </div>
    </section>

    <section class="top-10-wrapper">
        <div class="top-10-header"><i class="" style="color:var(--primary-color); font-size: 2.5rem;"></i><h2>Top 5 phim b·ªô h√¥m nay <i class="fas fa-chevron-right"></i></h2></div>
        <div class="top-5-grid" id="top5List"></div>
    </section>

    <section class="cinema-section">
        <div class="cinema-header">
            <h2>M√£n Nh√£n v·ªõi Phim Chi·∫øu R·∫°p <i class="fas fa-chevron-right"></i></h2>
            <div class="cinema-nav">
                <button onclick="scrollCinema(-1)"><i class="fas fa-chevron-left"></i></button>
                <button onclick="scrollCinema(1)"><i class="fas fa-chevron-right"></i></button>
            </div>
        </div>
    
        <div class="cinema-grid" id="cinemaList">
            <div style="color:#ccc; padding:20px;">ƒêang t·∫£i...</div>
        </div>
    </section>

    <section class="top-10-wrapper">
        <div class="top-10-header">
            <i class="" style="color:var(--primary-color); font-size: 2.5rem;"></i>
            <h2>Top 5 phim l·∫ª h√¥m nay <i class="fas fa-chevron-right"></i></h2>
        </div>
        <div class="top-5-grid" id="top5MoviesList"></div>
    </section>
    <div id="modalPopup" class="modal">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:40px; border-bottom:1px solid #222; padding-bottom:20px;">
            <h2 id="modalTitle" class="text-gradient" style="font-size: 2rem;">Danh s√°ch phim</h2>
            <i class="fas fa-times" onclick="closeModal()" style="font-size:2.5rem; color:#fff; cursor:pointer;"></i>
        </div>
        <div id="modalContent" class="modal-grid"></div>
    </div>

    <div class="ad-panel-wrapper">
        <a href="https://wibuphim.netlify.app" target="_blank" class="ad-link">
            <img src="https://wibuphim.netlify.app/WIBUPHIMADS.PNG" alt="Qu·∫£ng c√°o" class="ad-img-728">
        </a>
    </div>

<footer>
    <div class="footer-grid">
        <div class="footer-col">
            <div class="footer-logo">
                <img src="/LOGO.WEBP" alt="WibuPhim">
                <span class="text-gradient brand-text">WIBUPHIM</span>
            </div>
            <p class="footer-desc">
                WibuPhim - N·ªÅn t·∫£ng xem phim tr·ª±c tuy·∫øn mi·ªÖn ph√≠ ch·∫•t l∆∞·ª£ng cao. C·∫≠p nh·∫≠t li√™n t·ª•c, kh√¥ng gi·∫≠t lag, tr·∫£i nghi·ªám ƒëi·ªán ·∫£nh ƒë·ªânh cao ngay t·∫°i nh√†.
            </p>
            <div class="footer-socials">
                <a href="https://www.facebook.com/wibuteam2026" class="social-link"><i class="fab fa-facebook-f"></i></a>
                <a href="https://www.facebook.com/wibuteam2026" class="social-link"><i class="fab fa-discord"></i></a>
                <a href="https://www.facebook.com/wibuteam2026" class="social-link"><i class="fab fa-tiktok"></i></a>
                <a href="https://www.facebook.com/wibuteam2026" class="social-link"><i class="fab fa-telegram-plane"></i></a>
            </div>
        </div>

        <div class="footer-col">
            <h4>Kh√°m Ph√°</h4>
            <ul class="footer-links">
                <li><a href="#" onclick="loadCategory('phim-moi', 'Phim M·ªõi')">Phim M·ªõi C·∫≠p Nh·∫≠t</a></li>
                <li><a href="#" onclick="loadCategory('phim-le', 'Phim L·∫ª')">Phim Chi·∫øu R·∫°p</a></li>
                <li><a href="#" onclick="loadCategory('phim-bo', 'Phim B·ªô')">Phim B·ªô ƒê·ªôc Quy·ªÅn</a></li>
                <li><a href="#" onclick="loadCategory('tv-shows', 'TV Shows')">TV Shows</a></li>
            </ul>
        </div>

        <div class="footer-col">
            <h4>H·ªó Tr·ª£</h4>
            <ul class="footer-links">
                <li><a href="lienhequangcao.html">Li√™n h·ªá qu·∫£ng c√°o</a></li>
                <li><a href="baoloi.html">B√°o l·ªói phim</a></li>
                <li><a href="dieukhoan.html">ƒêi·ªÅu kho·∫£n d·ªãch v·ª•</a></li>
                <li><a href="https://wibuteam.netlify.app" target="_blank">V·ªÅ WibuTeam</a></li>
            </ul>
        </div>

        <div class="footer-col">
            <h4>T·∫£i ·ª®ng D·ª•ng</h4>
            <div class="download-group">
                <button class="btn-download-app">
                    <i class="fab fa-apple"></i>
                    <div class="btn-content">
                        <span class="btn-small-text">Download on the</span>
                        <span class="btn-big-text">App Store</span>
                    </div>
                </button>
                
                <button class="btn-download-app">
                    <i class="fab fa-google-play"></i>
                    <div class="btn-content">
                        <span class="btn-small-text">Get it on</span>
                        <span class="btn-big-text">Google Play</span>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <div class="footer-bottom">
        <span>&copy; 2026 WibuPhim. All Rights Reserved By WibuTeam.</span>
    </div>
</footer>

    <script src="chatbot.js"></script>
    <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, doc, getDoc, updateDoc, setDoc, onSnapshot, increment } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // 1. C·∫§U H√åNH FIREBASE
        const firebaseConfig = { 
            apiKey: "AIzaSyAT6SnKojUmsisDhnuEtsL3H59NwrhZxDc", 
            authDomain: "hopphim-29e1c.firebaseapp.com", 
            projectId: "hopphim-29e1c", 
            storageBucket: "hopphim-29e1c.firebasestorage.app", 
            messagingSenderId: "1076044580405", 
            appId: "1:1076044580405:web:a3485f8533604f305e537c", 
            measurementId: "G-6RT4CX2NR0" 
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- 2. H√ÄM MUA G√ìI VIP (G√ÅN V√ÄO WINDOW ƒê·ªÇ HTML G·ªåI ƒê∆Ø·ª¢C) ---
        window.buyVipPackage = async () => {
            if (!window.currentUser) {
                window.showToast("Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ mua VIP!", "error");
                return;
            }
            
            const confirmBuy = await window.customConfirm("Gia h·∫°n VIP 30 ng√†y v·ªõi 50 Coin?");
            if (!confirmBuy) return;

            const userRef = doc(db, "users", window.currentUser.uid);
            
            try {
                const snap = await getDoc(userRef);
                // N·∫øu User ch∆∞a t·ª´ng c√≥ d·ªØ li·ªáu trong Firestore, t·∫°o m·ªõi document v·ªõi balance = 0
                let data = snap.exists() ? snap.data() : { coinBalance: 0 };
                
                const currentBalance = data.coinBalance || 0;

                if (currentBalance < 50) {
                    window.showToast("S·ªë d∆∞ kh√¥ng ƒë·ªß! C·∫ßn 50 Coin.", "error");
                    setTimeout(() => window.location.href = '/nap-coin.html', 1500);
                    return;
                }

                const thirtyDaysMs = 30 * 24 * 60 * 60 * 1000;
                let newExpiration = Date.now() + thirtyDaysMs;

                if (data.vipExpiration && data.vipExpiration > Date.now()) {
                    newExpiration = data.vipExpiration + thirtyDaysMs;
                }

                // üî• D√πng setDoc thay v√¨ updateDoc ƒë·ªÉ an to√†n h∆°n
                await setDoc(userRef, {
                    coinBalance: increment(-50),
                    vipExpiration: newExpiration
                }, { merge: true });

                window.showToast("Mua VIP th√†nh c√¥ng! H·ªá th·ªëng ƒëang c·∫≠p nh·∫≠t...", "success");
            } catch (e) {
                console.error("L·ªói giao d·ªãch:", e);
                window.showToast("L·ªói h·ªá th·ªëng, vui l√≤ng th·ª≠ l·∫°i sau!", "error");
            }
        };

        // --- 3. QU·∫¢N L√ù TR·∫†NG TH√ÅI NG∆Ø·ªúI D√ôNG & GIAO DI·ªÜN ---
        onAuthStateChanged(auth, async (user) => {
            const btnLogin = document.getElementById('btnLogin');
            const userAvatar = document.getElementById('userAvatar');
            const userNameDisplay = document.getElementById('userNameDisplay');
            const mobileMemberBtn = document.getElementById('mobileMemberBtn');
            const drawerLogout = document.getElementById('drawerLogout');
            const vipStatusLabel = document.getElementById('vipStatus'); // ID Free Plan
            const adPanels = document.querySelectorAll('.ad-panel-wrapper');
            const adOverlay = document.getElementById('ad-overlay');

            if (user) {
                window.currentUser = user;
                
                if(btnLogin) btnLogin.style.display = 'none';
                if(userAvatar) { 
                    userAvatar.style.display = 'block'; 
                    userAvatar.src = user.photoURL || '/Guest.webp'; 
                }

                // L·∫ÆNG NGHE D·ªÆ LI·ªÜU USER REAL-TIME
                onSnapshot(doc(db, "users", user.uid), (docSnap) => {
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        const balance = data.coinBalance || 0;
                        const vipExp = data.vipExpiration || 0;
                        const isVip = vipExp > Date.now(); 
                        const name = user.displayName || "Th√†nh vi√™n";
                        
                        // 1. X·ª≠ l√Ω Hi·ªáu ·ª©ng Nh√† Vua (VIP King)
                        if (isVip) {
                            if(userAvatar) userAvatar.classList.add('vip-glow');
                            if(userNameDisplay) userNameDisplay.innerHTML = `<span class="vip-name"><i class="fas fa-crown"></i> ${name}</span>`;
                        } else {
                            if(userAvatar) userAvatar.classList.remove('vip-glow');
                            if(userNameDisplay) userNameDisplay.innerText = name;
                        }

                        // üî• 2. HI·ªÇN TH·ªä TH·ªúI H·∫†N VIP THAY CHO FREE PLAN üî•
                        if (vipStatusLabel) {
                            if (isVip) {
                            const d = new Date(vipExp);
                            const dateStr = `${d.getDate()}/${d.getMonth() + 1}/${d.getFullYear()}`;
                            vipStatusLabel.innerHTML = `<span style="color:#FFD700; font-weight:bold;"><i class="fas fa-gem"></i> VIP ƒë·∫øn: ${dateStr}</span>`;
                        } else {
                                vipStatusLabel.innerHTML = `<i class="fas fa-crown"></i> Free Plan`;
                            }
                        }

                        // 3. Th√™m Badge s·ªë d∆∞
                        const balanceHTML = `<span class="balance-badge"><i class="fas fa-coins"></i> ${balance.toLocaleString()}</span>`;
                        if(userNameDisplay) userNameDisplay.innerHTML += " " + balanceHTML;

                        // 4. Logic ·∫©n qu·∫£ng c√°o
                        if (isVip) {
                            adPanels.forEach(p => p.style.display = 'none');
                            if(adOverlay) adOverlay.style.display = 'none';
                        } else {
                            adPanels.forEach(p => p.style.display = 'flex');
                        }
                        
                        // 5. C·∫≠p nh·∫≠t Mobile Menu
                        if(mobileMemberBtn) {
                             const photo = user.photoURL || '/Guest.webp';
                             const nameHtmlMobile = isVip ? `<span class="vip-name"><i class="fas fa-crown"></i> ${name}</span>` : `<span>${name}</span>`;
                             mobileMemberBtn.innerHTML = `
                                <img src="${photo}" style="width:30px;height:30px;border-radius:50%;object-fit:cover;border:2px solid #fff;" class="${isVip ? 'vip-glow' : ''}"> 
                                ${nameHtmlMobile} ${balanceHTML}
                            `;
                        }
                    }
                });

                if(drawerLogout) drawerLogout.style.display = 'flex';
                loadHistory(user.uid);

            } else {
                // KHI CH∆ØA ƒêƒÇNG NH·∫¨P
                window.currentUser = null;
                if(btnLogin) btnLogin.style.display = 'block';
                if(userAvatar) userAvatar.style.display = 'none';
                if(mobileMemberBtn) {
                    mobileMemberBtn.innerHTML = `<i class="fas fa-user-circle"></i> <span>ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</span>`;
                    mobileMemberBtn.onclick = () => window.location.href = '/login.html';
                }
                if(drawerLogout) drawerLogout.style.display = 'none';
                adPanels.forEach(p => p.style.display = 'flex');
            }
        });
        
        // ... (Gi·ªØ nguy√™n c√°c h√†m ph·ª• tr·ª£ kh√°c nh∆∞ search, modal...)
        // (B·∫°n kh√¥ng c·∫ßn copy l·∫°i c√°c h√†m b√™n d∆∞·ªõi onAuthStateChanged n·∫øu ch√∫ng ƒë√£ c√≥ trong file g·ªëc)

        // --- 2. H√ÄM TH√îNG B√ÅO (TOAST) - G√°n v√†o Window ƒë·ªÉ d√πng to√†n c·ª•c ---
        window.showToast = (msg, type = 'success') => {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            const icon = type === 'success' ? '<i class="fas fa-check-circle" style="color:#2ecc71"></i>' : '<i class="fas fa-exclamation-triangle" style="color:#ff4757"></i>';
            toast.innerHTML = `${icon} <span>${msg}</span>`;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.transition = "0.4s";
                toast.style.opacity = "0";
                toast.style.transform = "translateX(100%)";
                setTimeout(() => toast.remove(), 400);
            }, 3000);
        }

        // --- 3. H√ÄM H·ªòP THO·∫†I X√ÅC NH·∫¨N (CONFIRM) ---
        window.customConfirm = (msg) => {
            return new Promise((resolve) => {
                const modal = document.getElementById('confirmModal');
                const msgEl = document.getElementById('confirmMsg');
                const btnYes = document.getElementById('btnConfirmYes');
                const btnNo = document.getElementById('btnConfirmNo');

                msgEl.innerText = msg;
                modal.classList.add('active');

                // X·ª≠ l√Ω s·ª± ki·ªán click
                const handleYes = () => { cleanup(); resolve(true); };
                const handleNo = () => { cleanup(); resolve(false); };

                const cleanup = () => {
                    modal.classList.remove('active');
                    btnYes.onclick = null;
                    btnNo.onclick = null;
                }

                btnYes.onclick = handleYes;
                btnNo.onclick = handleNo;
            });
        }

        // --- 4. CH·ª®C NƒÇNG ƒêƒÇNG XU·∫§T (ƒê√É FIX) ---
        window.logout = async () => {
            const ok = await window.customConfirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?");
            if(ok) {
                try {
                    await signOut(auth);
                    window.showToast("ƒê√£ ƒëƒÉng xu·∫•t th√†nh c√¥ng!");
                    
                    // ƒê√≥ng c√°c menu th·ªß c√¥ng ƒë·ªÉ tr√°nh l·ªói ph·ª• thu·ªôc
                    document.getElementById('mobileMenuOverlay').classList.remove('active');
                    document.getElementById('userMenu').classList.remove('active');
                } catch (e) {
                    console.error(e);
                    window.showToast("L·ªói ƒëƒÉng xu·∫•t", "error");
                }
            }
        }

        // --- 5. LOGIC D·ªÆ LI·ªÜU (L·ªäCH S·ª¨ & DANH S√ÅCH) ---
        
        // L∆∞u l·ªãch s·ª≠
        window.saveToHistory = async (slug, name, thumb) => {
            if (!window.currentUser) return;
            const ref = doc(db, "users", window.currentUser.uid);
            try {
                const snap = await getDoc(ref);
                let history = snap.exists() ? (snap.data().watchHistory || []) : [];
                history = history.filter(m => m.slug !== slug);
                history.push({ slug, name, thumb_url: thumb, timestamp: Date.now() });
                if (history.length > 15) history.shift();
                
                if(snap.exists()) await updateDoc(ref, { watchHistory: history });
                else await setDoc(ref, { email: window.currentUser.email, watchHistory: history });
                
                loadHistory(window.currentUser.uid);
            } catch (e) {}
        };

        // Load l·ªãch s·ª≠
        async function loadHistory(uid) {
            try {
                const snap = await getDoc(doc(db, "users", uid));
                if(snap.exists() && snap.data().watchHistory && snap.data().watchHistory.length > 0) {
                    window.renderHistoryRow(snap.data().watchHistory.reverse().slice(0, 8));
                } else {
                    document.getElementById('history-container').innerHTML = '';
                }
            } catch(e) {}
        }

        // Xo√° phim kh·ªèi l·ªãch s·ª≠ (ƒê√£ Fix: T√¨m Card Ch√≠nh X√°c + Toast Ngay)
        window.removeFromHistory = async (slug, btnElement) => {
            if (!window.currentUser) { 
                window.showToast("B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p!", "error"); 
                return; 
            }

            // 1. X√°c ƒë·ªãnh Card phim ƒë·ªÉ x√≥a ngay tr√™n giao di·ªán cho nhanh
            const card = btnElement.closest('.n-card');
            if (card) {
                card.style.transition = 'all 0.3s ease';
                card.style.opacity = '0';
                card.style.transform = 'scale(0.5)';
                setTimeout(() => card.remove(), 300);
            }

            // 2. X·ª≠ l√Ω tr√™n Firebase
            const ref = doc(db, "users", window.currentUser.uid);
            try {
                const snap = await getDoc(ref);
                if (snap.exists()) {
                    let history = snap.data().watchHistory || [];
                    
                    // GI·∫¢I M√É SLUG ƒê·ªÇ SO S√ÅNH CH√çNH X√ÅC (Tr√°nh l·ªói YouTube slug)
                    const targetSlug = decodeURIComponent(slug);
                    
                    const newHistory = history.filter(m => {
                        const currentSlug = decodeURIComponent(m.slug);
                        return currentSlug !== targetSlug;
                    });

                    // Ghi ƒë√® l·∫°i danh s√°ch m·ªõi
                    await updateDoc(ref, { watchHistory: newHistory });
                    
                    window.showToast("ƒê√£ x√≥a kh·ªèi danh s√°ch xem ti·∫øp", "success");

                    // N·∫øu x√≥a h·∫øt s·∫°ch phim th√¨ ·∫©n lu√¥n khung "Xem ti·∫øp"
                    const historyList = document.getElementById('historyList');
                    if (historyList && historyList.children.length <= 1) {
                        document.getElementById('history-container').innerHTML = '';
                    }
                }
            } catch (e) { 
                console.error("L·ªói x√≥a:", e);
                window.showToast("Kh√¥ng th·ªÉ x√≥a l√∫c n√†y, vui l√≤ng th·ª≠ l·∫°i!", "error");
            }
        };

        // L∆∞u phim y√™u th√≠ch
        window.addToMyList = async (slug, name, thumb) => {
            if (!window.currentUser) { 
                window.showToast("Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ l∆∞u phim!", "error"); 
                return; 
            }
            const ref = doc(db, "users", window.currentUser.uid);
            const snap = await getDoc(ref);
            let list = snap.exists() ? (snap.data().myList || []) : [];
            if (list.some(m => m.slug === slug)) { window.showToast("Phim ƒë√£ c√≥ trong danh s√°ch!", "error"); return; }
            
            list.push({ slug, name, thumb_url: thumb, timestamp: Date.now() });
            
            if(snap.exists()) await updateDoc(ref, { myList: list }); 
            else await setDoc(ref, { email: window.currentUser.email, myList: list });
            
            window.showToast(`ƒê√£ th√™m "${name}" v√†o danh s√°ch!`, "success");
        };
        
        // Helper UI
        window.toggleUserDropdown = () => document.getElementById('userMenu').classList.toggle('active');
        window.handleUserClick = () => { window.location.href = window.currentUser ? '/profile.html' : '/login.html'; }


// ============================================================
    // üî• B·ªî SUNG C√ÅC H√ÄM X·ª¨ L√ù MENU & MODAL (C√íN THI·∫æU)
    // ============================================================

    // 1. H√†m hi·ªÉn th·ªã Modal chung
    function showModal(title) {
        const modal = document.getElementById('modalPopup');
        const modalContent = document.getElementById('modalContent');
        const modalTitle = document.getElementById('modalTitle');
        
        if (modalTitle) modalTitle.innerText = title;
        if (modal) modal.classList.add('active');
        if (modalContent) modalContent.innerHTML = `<div style="grid-column:1/-1;text-align:center;padding:40px;color:#888;"><i class="fas fa-spinner fa-spin fa-2x"></i><br>ƒêang t·∫£i...</div>`;
    }

    // 2. H√†m Fetch API v√† Render ra Modal (ƒê√£ n√¢ng c·∫•p logic link)
    async function fetchAndRender(apiUrl) {
        try {
            const res = await fetch(apiUrl);
            const data = await res.json();
            const container = document.getElementById('modalContent');
            
            // üëá Ki·ªÉm tra xem API n√†y c√≥ ph·∫£i l√† c·ªßa Short Drama kh√¥ng
            const isShortDrama = apiUrl.includes('short-drama'); 
            
            if (data.data && data.data.items) {
                let html = '';
                data.data.items.forEach(m => {
                    const img = m.thumb_url.startsWith('http') ? m.thumb_url : `https://img.ophim1.com/uploads/movies/${m.thumb_url}`;
                    
                    // N·∫øu l√† Short Drama -> Link d·∫°ng /short/ten-phim
                    const linkUrl = isShortDrama ? `/short/${m.slug}` : `/xem-phim/${m.slug}`;

                    html += `
                    <div class="n-card" onclick="window.location.href='${linkUrl}'">
                        <img src="${img}" style="width:100%; height:100%; object-fit:cover; border-radius:12px; display:block !important;">
                        <div class="n-info-layer" style="padding:10px;"> 
                            <div class="n-title-in" style="font-size:0.9rem; font-weight:700; color:#fff;">${m.name}</div>
                            <div style="font-size:0.75rem; color:#aaa;">${m.year} ‚Ä¢ ${m.lang}</div>
                        </div>
                    </div>`;
                });
                container.innerHTML = html;
            } else {
                if(container) container.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:#ccc;">Kh√¥ng t√¨m th·∫•y phim.</div>';
            }
        } catch (e) {
            console.error(e);
            const container = document.getElementById('modalContent');
            if(container) container.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:#ff4757;">L·ªói k·∫øt n·ªëi server!</div>';
        }
    }

    // 3. H√†m g·ªçi t·ª´ Menu Th·ªÉ Lo·∫°i (G√°n v√†o window ƒë·ªÉ HTML g·ªçi ƒë∆∞·ª£c)
    window.loadCategory = async (slug, title) => {
        showModal(title);
        fetchAndRender(`https://ophim1.com/v1/api/the-loai/${slug}`);
    };

    // 4. H√†m g·ªçi t·ª´ Menu Qu·ªëc Gia
    window.openModal = async (slug, title) => {
        showModal(title);
        fetchAndRender(`https://ophim1.com/v1/api/quoc-gia/${slug}`);
    };

    // 5. H√†m ƒë√≥ng Modal
    window.closeModal = () => {
        const modal = document.getElementById('modalPopup');
        if(modal) modal.classList.remove('active');
    };
    </script>

    <script>
        // --- C·∫§U H√åNH PHIM C·ª¶A B·∫†N ---
        const MY_MOVIES = [
            {
                title: "Th·ªè ∆†i",
                origin: "Little Rabbit",
                titleImage: "tho-oi/logo.png",
                desc: "Phim ‚ÄúTh·ªè ∆°i!!‚Äù d·ª± ki·∫øn c√¥ng chi·∫øu trong d·ªãp T·∫øt 2026, thu·ªôc th·ªÉ lo·∫°i h√†i, t√¢m l√Ω s·ªü tr∆∞·ªùng c·ªßa Tr·∫•n Th√†nh, mang m√†u s·∫Øc tr·∫ª trung v·ªõi d√†n di·ªÖn vi√™n m·ªõi...",
                poster: "tho-oi/thumb.png",
                thumb: "tho-oi/thumb.png",
                ytId: "0H368WGBb_I", // Thay ID Youtube c·ªßa b·∫°n v√†o
                year: "2026",
                imdb: "6.0  ",
                episodes: "Full"
            },
            {
                title: "H·ªë S√¢u ·∫¢o V·ªçng",
                origin: "The Abyss Of Delusion",
                titleImage: "ho-sau-ao-vong/logo.png",
                desc: "ƒê√¢y l√† l·ªùi c·∫£nh t·ªânh m·∫°nh m·∫Ω v√† s√¢u s·∫Øc g·ª≠i ƒë·∫øn c·ªông ƒë·ªìng v·ªÅ hi·ªÉm h·ªça kh√¥n l∆∞·ªùng c·ªßa C√° ƒë·ªô b√≥ng ƒë√° tr·ª±c tuy·∫øn...",
                poster: "ho-sau-ao-vong/thumb.png",
                thumb: "ho-sau-ao-vong/thumb.png",
                ytId: "2x40K6FstAU", // Thay ID Youtube c·ªßa b·∫°n v√†o
                year: "2025",
                imdb: "3.6",
                episodes: "Full"
            },
            {
                title: "√Åp L·ª±c H·ªçc ƒê∆∞·ªùng",
                origin: "School Pressure",
                titleImage: "ap-luc-hoc-duong/logo.png",
                desc: "L·∫ßn ƒë·∫ßu b∆∞·ªõc v√†o m·ªôt m√¥i tr∆∞·ªùng ho√†n to√†n xa l·∫° ‚Äì n·ªôi tr√∫, b·∫°n m·ªõi, n·∫øp s·ªëng m·ªõi ‚Äì c√¥ b√© l·ªõp 10...",
                // H√£y thay b·∫±ng link ·∫£nh th·∫≠t c·ªßa b·∫°n (Up l√™n imgur ho·∫∑c host ·∫£nh)
                poster: "ap-luc-hoc-duong/thumb.png", 
                thumb: "ap-luc-hoc-duong/thumb.png",
                ytId: "i4RDEnNLbmw", // ID Youtube video
                year: "2025",
                imdb: "3.6",
                episodes: "Full"
            }
        ];

        let currentSlide = 0;
        let slideInterval;

        function renderHero() {
        const slidesContainer = document.getElementById('heroSlidesContainer');
        const thumbsContainer = document.getElementById('heroThumbnails');
        
        if(!slidesContainer) return;

        let slidesHtml = '';
        let thumbsHtml = '';

        MY_MOVIES.forEach((movie, index) => {
            const active = index === 0 ? 'active' : '';
            
            // --- LOGIC KI·ªÇM TRA LOGO ---
            // N·∫øu c√≥ titleImage th√¨ d√πng th·∫ª <img>, ng∆∞·ª£c l·∫°i d√πng th·∫ª <div> text c≈©
            const titleContent = movie.titleImage 
                ? `<img src="${movie.titleImage}" class="hero-title-image" alt="${movie.title}">`
                : `<div class="hero-title-main">${movie.title}</div>`;

            // Render Slide
            slidesHtml += `
                <div class="hero-slide ${active}" id="slide-${index}" style="background-image: url('${movie.poster}');">
                    <div class="hero-content">
                        
                        ${titleContent}

                        <div class="hero-origin-name">${movie.origin}</div>

                        <div class="hero-meta">
                            <span class="imdb-badge">IMDb ${movie.imdb}</span>
                            <span class="quality-badge">4K</span>
                            <span>${movie.year}</span>
                            <span>${movie.episodes}</span>
                        </div>
                        <div class="hero-desc">${movie.desc}</div>
                        <div class="hero-actions">
                            <div class="btn-play-circle" onclick="goToWatchPage('${movie.ytId}', '${movie.title}')">
                                <i class="fas fa-play"></i>
                            </div>
                            <div class="btn-action-icon" title="Th√™m v√†o danh s√°ch"><i class="fas fa-plus"></i></div>
                            <div class="btn-action-icon" title="Th√¥ng tin"><i class="fas fa-info"></i></div>
                        </div>
                    </div>
                </div>
            `;

            // Render Thumbnail (Gi·ªØ nguy√™n)
            thumbsHtml += `
                <div class="thumb-item ${active}" onclick="changeHeroSlide(${index})">
                    <img src="${movie.thumb}">
                </div>
            `;
        });

        slidesContainer.innerHTML = slidesHtml;
        thumbsContainer.innerHTML = thumbsHtml;
        
        // Reset timer ƒë·ªÉ tr√°nh l·ªói ch·ªìng ch√©o khi render l·∫°i
        clearInterval(slideInterval);
        startSlideTimer();
    }

        // --- H√ÄM CHUY·ªÇN H∆Ø·ªöNG SANG TRANG XEM PHIM ---
        function goToWatchPage(id, title) {
            // Chuy·ªÉn sang xem-phim.html v·ªõi tham s·ªë ƒë·∫∑c bi·ªát
            // custom=youtube: ƒê√°nh d·∫•u ƒë√¢y l√† phim Youtube
            // id: ID video Youtube
            // name: T√™n phim ƒë·ªÉ hi·ªÉn th·ªã
            const url = `/xem-phim/?custom=youtube&id=${id}&name=${encodeURIComponent(title)}`;
            window.location.href = url;
        }

        function changeHeroSlide(index) {
            clearInterval(slideInterval);
            startSlideTimer();

            document.querySelectorAll('.hero-slide').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.thumb-item').forEach(el => el.classList.remove('active'));

            const slide = document.getElementById(`slide-${index}`);
            if(slide) slide.classList.add('active');
            
            const thumb = document.querySelectorAll('.thumb-item')[index];
            if(thumb) thumb.classList.add('active');
            
            currentSlide = index;
        }

        function startSlideTimer() {
            slideInterval = setInterval(() => {
                let next = (currentSlide + 1) % MY_MOVIES.length;
                changeHeroSlide(next);
            }, 6000); 
        }

        // Init
        window.addEventListener('load', () => {
            renderHero();
        });
    </script>

    <script>
        const API_BASE = 'https://ophim1.com/v1/api';
        const IMG_BASE = 'https://img.ophim1.com/uploads/movies/';

        // --- TIME HELPER ---
        function timeAgo(timestamp) {
            if (!timestamp) return '';
            const seconds = Math.floor((Date.now() - timestamp) / 1000);
            if (seconds < 60) return "V·ª´a xong";
            const intervals = { nƒÉm: 31536000, th√°ng: 2592000, ng√†y: 86400, gi·ªù: 3600, ph√∫t: 60 };
            for (const [unit, sec] of Object.entries(intervals)) {
                const val = Math.floor(seconds / sec);
                if (val >= 1) return val + " " + unit + " tr∆∞·ªõc";
            }
            return "V·ª´a xong";
        }

        // --- RENDER CARD (ƒê√É FIX LINK SHORT/NORMAL) ---
        window.createMovieCardHTML = (m, isHistory = false, timeString = "") => {
            // 1. X·ª≠ l√Ω link ·∫£nh
            const imgWide = m.poster_url 
                ? (m.poster_url.startsWith('http') ? m.poster_url : IMG_BASE + m.poster_url) 
                : (m.thumb_url.startsWith('http') ? m.thumb_url : IMG_BASE + m.thumb_url);

            const imgPortrait = m.thumb_url.startsWith('http') ? m.thumb_url : IMG_BASE + m.thumb_url;

            // 2. X·ª≠ l√Ω t√™n & class
            const nameFixed = m.name.replace(/'/g, "\\'");
            const historyClass = isHistory ? `history-card-${m.slug}` : '';
            
            // 3. Logic ƒê·ªô tu·ªïi
            let ageTag = 'T13';
            // ... (Logic m√†u s·∫Øc gi·ªØ nguy√™n) ...
            let ageColor = '#2ed573'; 
            if (m.category) {
                const cats = m.category.map(c => c.slug);
                if (cats.some(s => s === 'kinh-di' || s === 'toi-pham' || s === '18')) {
                    ageTag = 'T18'; ageColor = '#ff4757'; 
                } else if (cats.some(s => s === 'hanh-dong' || s === 'vo-thuat' || s === 'chien-tranh')) {
                    ageTag = 'T16'; ageColor = '#ffa502'; 
                } else if (cats.some(s => s === 'hoat-hinh' || s === 'gia-dinh')) {
                    ageTag = 'P'; ageColor = '#00d2ff'; 
                }
            }

            // 4. L·∫•y danh s√°ch th·ªÉ lo·∫°i
            const genres = m.category ? m.category.slice(0, 2).map(c => c.name).join(' ‚Ä¢ ') : '';

            // 5. Badge t·∫≠p phim
            const epBadge = (isHistory && m.epName) 
                ? `<div style="position:absolute; top:10px; left:10px; background:var(--primary-color); color:#fff; padding:3px 8px; border-radius:5px; font-size:10px; font-weight:800; z-index:5; box-shadow:0 4px 10px rgba(0,0,0,0.5);">${m.epName.toUpperCase()}</div>` 
                : '';

            // üî• X·ª¨ L√ù LINK CHUY·ªÇN H∆Ø·ªöNG M·ªöI
            let redirectUrl = `/xem-phim/${m.slug}`; 

            if (m.type === 'short' || (m.category && m.category.some(c => c.slug === 'short-drama'))) {
                // Link m·ªõi: kh√¥ng d√πng d·∫•u ? n·ªØa
                redirectUrl = `/short/${m.slug}`; 
            }

            return `
            <div class="n-card ${historyClass}" onclick="window.location.href='${redirectUrl}'">
                ${epBadge}
                <img src="${imgWide}" class="n-poster-wide" loading="lazy">
                <img src="${imgPortrait}" class="n-poster-portrait" loading="lazy">
                
                <div class="n-info-layer" style="padding: 12px;"> 
                    <div class="n-title-in" style="margin-bottom: 0px; line-height: 1.1;">${m.name}</div>
                    
                    <div style="font-size: 0.75rem; color: #aaa; margin-bottom: 4px; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; line-height: 1.2;">
                        ${m.origin_name}
                    </div>

                    <div class="n-meta-in" style="flex-wrap: wrap; gap: 5px; margin-top: -4px;">
                        ${isHistory 
                            ? `<span style="color:#FF8F50; font-size: 0.8rem;"><i class="fas fa-history"></i> ${timeString}</span>` 
                            : `
                                <span style="background: #ccc; color:#181818; padding: 0px 5px; border-radius: 3px; font-size: 0.65rem; font-weight: 500; line-height: 16px; display: inline-block; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
                                    ${ageTag}
                                </span>
                                <span style="background: rgba(255,255,255,0.1); color: #ccc; padding: 0px 5px; border-radius: 3px; font-size: 0.65rem; font-weight: 500; height: 16px; line-height: 16px; display: inline-block;">
                                    ${m.year}
                                </span>
                                <span style="background: rgba(70, 211, 105, 0.1); color: #46d369; padding: 0px 5px; border-radius: 3px; font-size: 0.65rem; font-weight: 500; height: 16px; line-height: 16px; display: inline-block;">
                                    ${m.episode_current}
                                </span>
                            `
                        }
                    </div>
                    
                    ${!isHistory ? `<div style="font-size: 0.7rem; color: #777; margin-top: 0px; line-height: 1.2;">${genres}</div>` : ''}

                    <div class="n-actions-in" style="margin-top: 0px;">
                        <button class="btn-mini-play">
                            <i class="fas fa-play"></i> ${isHistory ? 'TI·∫æP T·ª§C' : 'XEM NGAY'}
                        </button>
                        
                        <button class="btn-mini-add" title="Th√™m v√†o y√™u th√≠ch" onclick="event.stopPropagation(); addToMyList('${m.slug}', '${nameFixed}', '${imgPortrait}')">
                            <i class="fas fa-plus"></i>
                        </button>

                        ${isHistory ? `<button class="btn-mini-remove" title="Xo√°" onclick="event.stopPropagation(); removeFromHistory('${m.slug}', this)"><i class="fas fa-minus"></i></button>` : ''}
                    </div>
                </div>
            </div>`;
        };
        
        // --- RENDER HISTORY ROW ---
        window.renderHistoryRow = (movies) => {
            const container = document.getElementById('history-container');
            if(!movies || movies.length === 0) { container.innerHTML = ''; return; }
            
            const historyGridId = 'historyList'; 
            let cards = movies.map(m => window.createMovieCardHTML(m, true, timeAgo(m.timestamp))).join('');
            
            container.innerHTML = `
                <div class="merged-block" style="margin-top:0; padding-bottom:30px;">
                    <div class="country-section" style="border:none;">
                        <div class="country-header">
                            <div class="ch-title"><i class="fas fa-clock" style="color:var(--primary-color); margin-right:10px;"></i> Xem ti·∫øp</div>
                        </div>
                        <div class="grid-wrapper">
                            <button class="nav-arrow arrow-prev" onclick="scrollGrid('${historyGridId}', -1)"><i class="fas fa-chevron-left"></i></button>
                            <div class="country-grid" id="${historyGridId}">${cards}</div>
                            <button class="nav-arrow arrow-next" onclick="scrollGrid('${historyGridId}', 1)"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>`;
        }

        /* ==============================================
           üî• FIX SEARCH LOGIC (T√åM KI·∫æM)
           ============================================== */
        let searchTimeout;
        const IMG_BASE_URL = 'https://img.ophim1.com/uploads/movies/';

        async function performSearch(keyword, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            if (!keyword || keyword.trim().length < 2) {
                container.innerHTML = '';
                container.classList.remove('active');
                return;
            }

            container.classList.add('active');
            container.innerHTML = '<div style="color:#aaa; padding:20px; text-align:center;"><i class="fas fa-spinner fa-spin"></i></div>';

            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(async () => {
                try {
                    const res = await fetch(`https://ophim1.com/v1/api/tim-kiem?keyword=${encodeURIComponent(keyword)}`);
                    const data = await res.json();

                    if (data.data && data.data.items && data.data.items.length > 0) {
                        let html = '';
                        data.data.items.slice(0, 10).forEach(m => {
                            const img = m.thumb_url.startsWith('http') ? m.thumb_url : IMG_BASE_URL + m.thumb_url;
                            html += `
                                <div class="search-result-item" onclick="window.location.href='/xem-phim/${m.slug}'">
                                    <img src="${img}" alt="${m.name}" loading="lazy">
                                    <div class="search-result-info">
                                        <div class="search-result-title">${m.name}</div>
                                        <div class="search-result-meta">${m.year} ‚Ä¢ ${m.origin_name}</div>
                                    </div>
                                </div>`;
                        });
                        container.innerHTML = html;
                    } else {
                        container.innerHTML = '<div style="color:#666; padding:20px; text-align:center;">Kh√¥ng t√¨m th·∫•y phim n√†o...</div>';
                    }
                } catch (e) {
                    container.innerHTML = '<div style="color:#ff4757; padding:20px; text-align:center;">L·ªói k·∫øt n·ªëi server!</div>';
                }
            }, 500);
        }

        // G√°n s·ª± ki·ªán cho Desktop
        const desktopSearch = document.getElementById('searchInput');
        if(desktopSearch) {
            desktopSearch.addEventListener('input', (e) => performSearch(e.target.value, 'desktopSearchResults'));
        }

        // G√°n s·ª± ki·ªán cho Mobile
        const mobileSearch = document.getElementById('mobileSearchInput');
        if(mobileSearch) {
            mobileSearch.addEventListener('input', (e) => performSearch(e.target.value, 'mobileSearchResults'));
        }

        // Click ra ngo√†i ƒë·ªÉ ·∫©n k·∫øt qu·∫£ Desktop
        document.addEventListener('click', (e) => {
            const box = document.querySelector('.search-box');
            const res = document.getElementById('desktopSearchResults');
            if (box && !box.contains(e.target) && res) {
                res.classList.remove('active');
            }
        });

        // H√†m m·ªü/ƒë√≥ng search mobile (D√πng chung cho to√†n web)
        window.openMobileSearch = () => {
            document.getElementById('mobileSearchOverlay').classList.add('active');
            setTimeout(() => document.getElementById('mobileSearchInput').focus(), 300);
        }
        window.closeMobileSearch = () => {
            document.getElementById('mobileSearchOverlay').classList.remove('active');
        }


        // --- H√ÄM ƒêO√ÅN ƒê·ªò TU·ªîI (N·∫øu ch∆∞a c√≥ th√¨ th√™m v√†o) ---
        function getAgeRating(movie) {
            // ∆Øu ti√™n n·∫øu API c√≥ s·∫µn field rating
            if (movie.content_rating) return movie.content_rating;
            if (!movie.category || movie.category.length === 0) return '13+';
            const slugs = movie.category.map(c => c.slug); 

            // --- LOGIC PH√ÇN LO·∫†I ---
            if (slugs.some(s => s === 'kinh-di' || s === 'toi-pham' || s === '18' || s === 'tam-ly-18')) {
                return 'T18';
            }
            if (slugs.some(s => s === 'hanh-dong' || s === 'vo-thuat' || s === 'tinh-cam' || s === 'tam-ly' || s === 'chien-tranh' || s === 'bi-an')) {
                return 'T16';
            }
            if (slugs.some(s => s === 'hoat-hinh' || s === 'gia-dinh')) {
                return 'P';
            }
            return 'T13';
        }

        // --- LOAD TOP 5 PHIM B·ªò (ƒê√É TH√äM T√äN TI·∫æNG ANH) ---
        async function loadTop5() {
            const MANUAL_TOP_5 = [
                "dai-chien-van-menh", 
                "trao-em-ca-vu-tru", 
                "con-ra-the-thong-gi-nua-2026", 
                "tieng-yeu-nay-anh-dich-duoc-khong", 
                "nghe-thuat-lua-doi-cua-sarah"
            ];
            
            const container = document.getElementById('top5List');
            if(!container) return;
            
            let html = '';
            
            for (let i = 0; i < MANUAL_TOP_5.length; i++) {
                try {
                    const res = await fetch(`${API_BASE}/phim/${MANUAL_TOP_5[i]}`);
                    const data = await res.json();
                    
                    if(data.status) {
                        const m = data.data.item;
                        const img = m.thumb_url.startsWith('http') ? m.thumb_url : `https://img.ophim1.com/uploads/movies/${m.thumb_url}`;
                        
                        // 1. X·ª≠ l√Ω ƒë·ªô tu·ªïi
                        const ageTag = getAgeRating(m);
                        let ageColor = '#ccc'; // Xanh l√°
                        if(ageTag === 'T18') ageColor = '#ccc'; // ƒê·ªè
                        if(ageTag === 'T16') ageColor = '#ccc'; // Cam

                        html += `
                        <div class="top-card-style2" onclick="window.location.href='/xem-phim/${m.slug}'">
                            <div class="top-poster-style2">
                                <img src="${img}" loading="lazy" alt="${m.name}">
                                
                                <div style="position:absolute; top:10px; right:10px; background:#FF8F50; color:#fff; font-size:0.65rem; font-weight:800; padding:3px 6px; border-radius:4px; box-shadow: 0 2px 5px rgba(0,0,0,0.3);">
                                    ${m.lang}
                                </div>
                            </div>
                            
                            <div class="top-info-row">
                                <div class="top-rank-style2">${i+1}</div>
                                
                                <div class="top-text-style2">
                                    <div class="top-title-style2" style="font-size: 1rem; margin-bottom: 2px;">
                                        ${m.name}
                                    </div>
                                    
                                    <div style="font-size: 0.8rem; color: #888; font-weight: 500; margin-bottom: 6px; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden;">
                                        ${m.origin_name}
                                    </div>
                                    
                                    <div class="top-meta-style2" style="gap: 8px; align-items: center;">
                                        <span style="color: ${ageColor}">${ageTag}</span>

                                        <span style="font-size: 0.7rem; color: #555;">‚óè</span>
                                        
                                        <span style= font-weight: 600; font-size: 0.66rem;">
                                            ${m.episode_current}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                    }
                } catch(e) { console.error(e); }
            }
            container.innerHTML = html;
        }

        // --- H√ÄM T·∫¢I PHIM CHI·∫æU R·∫†P (T·ª∞ CH·ªàNH LIST) ---
        async function loadCinemaMovies() {
            // üëá DANH S√ÅCH SLUG (B·∫°n th√™m bao nhi√™u phim c≈©ng ƒë∆∞·ª£c)
            const CINEMA_SLUGS = [
                "tu-chien-tren-khong",
                "co-hau-gai-2025",
                "ho-den-tu-than",
                "avatar-3-lua-va-tro-tan",
                "linh-truong",
                "phi-vu-dong-troi-2"
            ]; 
            
            const container = document.getElementById('cinemaList');
            if(!container) return;

            let html = '';

            for (const slug of CINEMA_SLUGS) {
                try {
                    const res = await fetch(`https://ophim1.com/v1/api/phim/${slug}`);
                    const data = await res.json();
                    
                    if(data.status) {
                        const m = data.data.item;
                        const posterUrl = m.poster_url.startsWith('http') ? m.poster_url : `https://img.ophim1.com/uploads/movies/${m.poster_url}`;
                        const thumbUrl = m.thumb_url.startsWith('http') ? m.thumb_url : `https://img.ophim1.com/uploads/movies/${m.thumb_url}`;

                        // --- 1. LOGIC ƒêO√ÅN ƒê·ªò TU·ªîI ---
                        let ageTag = 'T13';
                        let ageColor = '#ccc'; // M·∫∑c ƒë·ªãnh xanh l√° (An to√†n)

                        if (m.category) {
                            const cats = m.category.map(c => c.name.toLowerCase());
                            if (cats.some(c => c.includes('18+') || c.includes('ng∆∞·ªùi l·ªõn') || c.includes('kinh d·ªã') || c.includes('t·ªôi ph·∫°m'))) {
                                ageTag = 'T18'; ageColor = '#ccc'; // ƒê·ªè
                            } else if (cats.some(c => c.includes('h√†nh ƒë·ªông') || c.includes('v√µ thu·∫≠t') || c.includes('chi·∫øn tranh') || c.includes('t√¨nh c·∫£m'))) {
                                ageTag = 'T16'; ageColor = '#ccc'; // Cam
                            } else if (cats.some(c => c.includes('ho·∫°t h√¨nh') || c.includes('gia ƒë√¨nh'))) {
                                ageTag = 'P'; ageColor = '#ccc'; // Xanh d∆∞∆°ng
                            }
                        }
                        
                        // --- 2. LOGIC TH·ªúI L∆Ø·ª¢NG ---
                        // API th∆∞·ªùng tr·∫£ v·ªÅ "120 ph√∫t" ho·∫∑c "N/A"
                        const duration = m.time ? m.time.replace('ph√∫t', 'p') : 'ƒêang c·∫≠p nh·∫≠t';

                        html += `
                        <div class="cinema-card" onclick="window.location.href='/xem-phim/${m.slug}'">
                            <div class="cinema-bg">
                                <img src="${posterUrl}" loading="lazy" alt="${m.name}">
                                <div class="cinema-overlay"></div>
                                <div style="position:absolute; top:10px; right:10px; background:#FF8F50; color:#fff; font-size:0.65rem; font-weight:800; padding:3px 6px; border-radius:4px; box-shadow: 0 2px 5px rgba(0,0,0,0.3);">
                                    ${m.lang}
                                </div>
                            </div>
                            <div class="cinema-content">
                                <div class="cinema-poster-mini">
                                    <img src="${thumbUrl}" loading="lazy">
                                </div>
                                <div class="cinema-info">
                                    <div class="cinema-title-vi">${m.name}</div>
                                    <div class="cinema-title-en">${m.origin_name}</div>
                                    
                                    <div class="cinema-meta" style="display:flex; align-items:center; gap:8px; margin-top:5px;">
                                        <span style="color: ${ageColor}">${ageTag}</span>
                                        
                                        <span style="color:#aaa; font-size:0.7rem;">‚óè</span>
                                        
                                        <span style="color:#ccc;">${m.year}</span>
                                        
                                        <span style="color:#aaa; font-size:0.7rem;">‚óè</span>
                                        
                                        <span style="color:#ccc;">${duration}</span>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                    }
                } catch (e) {
                    console.error(`L·ªói t·∫£i phim ${slug}:`, e);
                }
            }
            container.innerHTML = html;
        }

        // --- H√ÄM ƒêI·ªÄU H∆Ø·ªöNG SCROLL ---
        window.scrollCinema = (direction) => {
            const container = document.getElementById('cinemaList');
            if (container) {
                // Cu·ªôn m·ªôt kho·∫£ng b·∫±ng 1/3 chi·ªÅu r·ªông m√†n h√¨nh
                const scrollAmount = container.clientWidth * 0.5;
                container.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
            }
        }

        // --- H√ÄM T·∫¢I TOP 5 PHIM L·∫∫ (T·ª∞ CH·ªàNH LIST) ---
        async function loadTop5Movies() {
            // Danh s√°ch phim l·∫ª c·ªßa b·∫°n
            const MANUAL_TOP_MOVIES = [
                "avatar-3-lua-va-tro-tan", 
                "quai-vat-nho-nui-lang-lang", 
                "tro-lai-qua-khu", 
                "ke-an-dat", 
                "phi-vu-dong-troi-2"
            ];
            
            const container = document.getElementById('top5MoviesList');
            if(!container) return;
            
            let html = '';
            
            for (let i = 0; i < MANUAL_TOP_MOVIES.length; i++) {
                try {
                    const res = await fetch(`${API_BASE}/phim/${MANUAL_TOP_MOVIES[i]}`);
                    const data = await res.json();
                    
                    if(data.status) {
                        const m = data.data.item;
                        // X·ª≠ l√Ω ·∫£nh
                        const img = m.thumb_url.startsWith('http') ? m.thumb_url : `https://img.ophim1.com/uploads/movies/${m.thumb_url}`;
                        
                        // 1. X·ª≠ l√Ω ƒê·ªô tu·ªïi (D√πng h√†m getAgeRating ƒë√£ c√≥)
                        const ageTag = getAgeRating(m);
                        let ageColor = '#ccc'; // Xanh l√°
                        if(ageTag === 'T18') ageColor = '#ccc'; // ƒê·ªè
                        if(ageTag === 'T16') ageColor = '#ccc'; // Cam

                        // 2. X·ª≠ l√Ω Th·ªùi l∆∞·ª£ng (ƒë·ªïi "ph√∫t" -> "p")
                        const duration = m.time ? m.time.replace('ph√∫t', 'p') : 'N/A';

                        html += `
                        <div class="top-card-style2" onclick="window.location.href='/xem-phim/${m.slug}'">
                            <div class="top-poster-style2">
                                <img src="${img}" loading="lazy" alt="${m.name}">
                                
                                <div style="position:absolute; top:10px; right:10px; background:#FF8F50; color:#fff; font-size:0.65rem; font-weight:800; padding:3px 6px; border-radius:4px; box-shadow: 0 2px 5px rgba(0,0,0,0.3);">
                                    ${m.lang}
                                </div>
                            </div>
                            
                            <div class="top-info-row">
                                <div class="top-rank-style2">${i+1}</div>
                                
                                <div class="top-text-style2">
                                    <div class="top-title-style2" style="font-size: 1rem; margin-bottom: 2px;">
                                        ${m.name}
                                    </div>
                                    
                                    <div style="font-size: 0.8rem; color: #888; font-weight: 500; margin-bottom: 6px; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden;">
                                        ${m.origin_name}
                                    </div>
                                    
                                    <div class="top-meta-style2" style="gap: 8px; align-items: center;">
                                        <span style="color: ${ageColor}">${ageTag}</span>
                                        
                                        <span style="font-size: 0.7rem; color: #555;">‚óè</span>
                                        
                                        <span style= font-weight: 600; font-size: 0.66rem;">${m.year}</span>
                                        
                                        <span style="font-size: 0.7rem; color: #555;">‚óè</span>
                                        
                                        <span style= font-weight: 600; font-size: 0.66rem;">${duration}</span>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                    }
                } catch(e) {
                    console.error("L·ªói t·∫£i phim l·∫ª:", e);
                }
            }
            container.innerHTML = html;
        }
        // --- OTHER LOAD FUNCTIONS ---
        async function loadCountrySection(slug, elementId) {
            try {
                const res = await fetch(`${API_BASE}/quoc-gia/${slug}?page=1`);
                const data = await res.json();
                if(data.data) {
                    let html = '';
                    data.data.items.slice(0, 16).forEach(m => html += window.createMovieCardHTML(m));
                    document.getElementById(elementId).innerHTML = html;
                }
            } catch(e) {}
        }

        window.scrollGrid = (id, direction) => {
            const el = document.getElementById(id);
            if(el) el.scrollBy({ left: direction * el.clientWidth, behavior: 'smooth' });
        };

        window.openModal = async (slug, title) => {
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalPopup').classList.add('active');
            const res = await fetch(`${API_BASE}/quoc-gia/${slug}?page=1`);
            const data = await res.json();
            const container = document.getElementById('modalContent');
            let html = '';
            if(data.data) {
                data.data.items.forEach(m => {
                    const img = m.thumb_url.startsWith('http') ? m.thumb_url : IMG_BASE + m.thumb_url;
                    html += `<div class="modal-card" onclick="window.location.href='/xem-phim/${m.slug}'"><img src="${img}" style="width:100%; border-radius:8px;"><div style="padding:15px; font-weight:700; font-size:0.9rem; color:#fff;">${m.name}</div></div>`;
                });
            }
            container.innerHTML = html;
        }

        // --- H√ÄM T·∫¢I TH·ªÇ LO·∫†I (ƒê√É S·ª¨A L·ªñI ·∫¢NH) ---
        window.loadCategory = async (slug, title) => {
            const modal = document.getElementById('modalPopup');
            const modalContent = document.getElementById('modalContent');
            const modalTitle = document.getElementById('modalTitle');

            if (modalTitle) modalTitle.innerText = title;
            if (modal) modal.classList.add('active');
            
            if (modalContent) {
                modalContent.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; color: #a0a0a0; padding: 40px;">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--primary-color); margin-bottom: 15px;"></i>
                        <br>ƒêang t·∫£i phim ${title}...
                    </div>
                `;
            }

            try {
                // G·ªçi API
                const res = await fetch(`https://ophim1.com/v1/api/the-loai/${slug}`);
                const data = await res.json();

                if (data.data && data.data.items) {
                    let html = '';
                    data.data.items.forEach(m => {
                        // X·ª≠ l√Ω link ·∫£nh
                        const img = m.thumb_url.startsWith('http') 
                            ? m.thumb_url 
                            : `https://img.ophim1.com/uploads/movies/${m.thumb_url}`;
                        
                        // Render Card
                        html += `
                        <div class="n-card" onclick="window.location.href='/xem-phim/${m.slug}'">
                            <img src="${img}" loading="lazy" style="width:100%; height:100%; object-fit:cover; border-radius:12px; display:block;">
                            
                            <div class="n-info-layer" style="padding:10px;"> 
                                <div class="n-title-in" style="font-size:0.9rem;">${m.name}</div>
                                <div style="font-size:0.75rem; color:#aaa;">${m.year} ‚Ä¢ ${m.lang}</div>
                            </div>
                        </div>`;
                    });
                    modalContent.innerHTML = html;
                } else {
                    modalContent.innerHTML = '<div style="grid-column: 1 / -1; text-align:center; color:#ccc;">Kh√¥ng t√¨m th·∫•y phim n√†o.</div>';
                }
            } catch (e) {
                console.error(e);
                if (modalContent) modalContent.innerHTML = '<div style="grid-column: 1 / -1; text-align:center; color:#ff4757;">L·ªói k·∫øt n·ªëi server!</div>';
            }
        };

        window.closeModal = () => document.getElementById('modalPopup').classList.remove('active');
        
        // MOBILE HANDLERS
        window.openMobileMenu = () => { document.getElementById('mobileMenuOverlay').classList.add('active'); }
        window.closeMobileMenu = () => { document.getElementById('mobileMenuOverlay').classList.remove('active'); }
        
        window.openMobileSearch = () => { 
            const overlay = document.getElementById('mobileSearchOverlay');
            overlay.classList.add('active'); 
            setTimeout(() => document.getElementById('mobileSearchInput').focus(), 300);
        }
        window.closeMobileSearch = () => { document.getElementById('mobileSearchOverlay').classList.remove('active'); }
        
        window.loadHome = () => window.location.href = '/';

        // --- H√ÄM LOAD SHORT DRAMA (SLIDER) ---
        async function loadShortDramaSection() {
            const container = document.getElementById('shortDramaContainer');
            if(!container) return;

            try {
                // L·∫•y 24 phim ƒë·ªÉ c√≥ ƒë·ªß n·ªôi dung m√† tr∆∞·ª£t
                const res = await fetch(`${API_BASE}/the-loai/short-drama?page=1`);
                const data = await res.json();

                if (data.data && data.data.items) {
                    let html = '';
                    const items = data.data.items.slice(0, 24); 

                    items.forEach(m => {
                        const img = m.thumb_url.startsWith('http') ? m.thumb_url : `https://img.ophim1.com/uploads/movies/${m.thumb_url}`;
                        const cleanName = m.name.replace('Phim', '').trim();
                        
                        // Logic s·ªë t·∫≠p
                        let epText = m.episode_current || '';
                        if (epText.includes('(') && epText.includes(')')) {
                            let match = epText.match(/\((.*?)\)/);
                            if (match) epText = match[1];
                        }
                        if (!epText || epText.toLowerCase() === 'full') epText = 'Full';

                        html += `
                            <div class="short-card" onclick="window.location.href='/short/${m.slug}'" title="${m.name}">
                                <div class="short-ep-badge">${epText}</div>
                                <img src="${img}" loading="lazy" alt="${m.name}">
                                <div class="short-info">
                                    <div class="short-title">${cleanName}</div>
                                </div>
                            </div>
                        `;
                    });
                    container.innerHTML = html;
                }
            } catch (e) {
                console.error("L·ªói Short Drama:", e);
                container.innerHTML = `<div style="padding:20px; color:#ff4757">L·ªói t·∫£i d·ªØ li·ªáu.</div>`;
            }
        }

        // --- H√ÄM ƒêI·ªÄU H∆Ø·ªöNG SHORT DRAMA ---
        window.scrollShorts = (direction) => {
            const container = document.getElementById('shortDramaContainer');
            if (container) {
                // Cu·ªôn m·ªôt kho·∫£ng b·∫±ng 70% chi·ªÅu r·ªông container (tr∆∞·ª£t g·∫ßn h·∫øt m√†n h√¨nh)
                const scrollAmount = container.clientWidth * 0.7;
                container.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
            }
        }

        // --- INIT & EVENT LISTENERS ---
        window.addEventListener('load', () => {
            loadTop5();
            loadTop5Movies();
            loadCinemaMovies();
            loadCountrySection('han-quoc', 'koreaList');
            loadCountrySection('trung-quoc', 'chinaList');
            loadCountrySection('thai-lan', 'thaiList');
            loadShortDramaSection();

            // --- üî• LOGIC ZOOM OUT (ƒê√É S·ª¨A) ---
            const screen = document.getElementById('loadingScreen');
            const img = screen.querySelector('.loading-img');

            // --- TRONG PH·∫¶N SCRIPT C·ª¶A INDEX.HTML ---
            setTimeout(() => {
                if(img) {
                    img.classList.add('zoom-out');
                    setTimeout(() => {
                        screen.style.display = 'none';
                        
                        // üî• G·ªåI H√ÄM HI·ªÜN CHATBOT T·∫†I ƒê√ÇY üî•
                        if (window.showChatbot) {
                            window.showChatbot();
                        }
                        
                    }, 480); 
                } else {
                    screen.style.display = 'none';
                    if (window.showChatbot) window.showChatbot(); // Ph√≤ng tr∆∞·ªùng h·ª£p ko c√≥ ·∫£nh
                }
            }, 1000);

            // --- üî• G√ÅN S·ª∞ KI·ªÜN T√åM KI·∫æM ---
            const mobileInput = document.getElementById('mobileSearchInput');
            if(mobileInput) {
                mobileInput.addEventListener('input', (e) => performSearch(e.target.value, 'mobileSearchResults'));
            }

            const desktopInput = document.getElementById('searchInput');
            if(desktopInput) {
                desktopInput.addEventListener('input', (e) => performSearch(e.target.value, 'desktopSearchResults'));
                
                // ·∫®n k·∫øt qu·∫£ khi click ra ngo√†i
                document.addEventListener('click', (e) => {
                    const searchBox = document.querySelector('.search-box');
                    const results = document.getElementById('desktopSearchResults');
                    if (searchBox && !searchBox.contains(e.target) && results) {
                        results.classList.remove('active');
                    }
                });
            }
        });

        window.addEventListener('scroll', () => {
            document.getElementById('siteHeader').classList.toggle('scrolled', window.scrollY > 50);
        });
    </script>

    <script src="backtotop.js"></script>

    </body>
    </html>